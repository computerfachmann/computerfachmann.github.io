{"version":3,"sources":["ui/common/SearchBar.js","ui/assets/logo.svg","ui/common/LoadingIndicator.js","ui/assets/s2.png","ui/assets/doi.svg","ui/assets/pdf.png","services/api.js","ui/search/SeedPaperSearchModal.js","ui/constants/colors.js","ui/common/Citrus.js","ui/search/SearchContainer.js","ui/constants/constants.js","ui/Home.js","state-management/search/actions.js","ui/search/ForceGraph.js","ui/search/Legend.js","ui/assets/bibtex.png","utils/bibtex.js","ui/search/PublicationDetail.js","ui/assets/pin-tab.gif","ui/search/BrowseModal.js","ui/search/PublicationPanel.js","ui/search/SearchResults.js","ui/search/Search.js","ui/App.js","state-management/search/reducer.js","state-management/rootReducer.js","state-management/search/saga.js","state-management/rootSaga.js","state-management/store.js","serviceWorker.js","index.js"],"names":["styles","root","height","display","justifyContent","iconButton","color","transform","iconButtonHidden","opacity","searchIconButton","marginRight","input","width","searchContainer","margin","SearchBar","React","forwardRef","ref","cancelOnEscape","settingsIcon","className","classes","showSettingsButton","highlightSettingsButton","highlightSearchButton","onClickSettings","disabled","onCancelSearch","onRequestSearch","searchIcon","style","inputProps","inputRef","useRef","useState","value","setValue","useEffect","handleFocus","useCallback","e","onFocus","handleBlur","v","trim","onBlur","handleInput","target","onChange","handleCancel","handleRequestSearch","handleClickSettings","handleKeyUp","charCode","key","onKeyUp","useImperativeHandle","focus","current","blur","Paper","Input","fullWidth","disableUnderline","IconButton","onClick","cloneElement","icon","defaultProps","placeholder","LoadingIndicator","size","textAlign","animation","src","logo","alt","baseUrl","process","search","query","a","requestOptions","method","headers","body","JSON","stringify","textQuery","seedPaperIds","limit","maxPublicationCount","fetch","response","json","parsedResponse","encodeURIComponent","publicationId","withConnect","connect","state","dispatch","compose","open","onClose","addSeedPaper","addSeedPaperDisabled","mounted","loading","setLoading","error","setError","publications","setPublications","searchQuery","setSearchQuery","Set","expandedSet","setExpandedSet","showAllAuthorsSet","setShowAllAuthorsSet","onError","err","console","log","onResult","publicationList","map","publication","authors","year","length","has","Id","author","name","reduce","prev","next","firstAuthors","slice","Button","variant","textTransform","fontSize","marginTop","marginLeft","newSet","add","sx","p","m","trimmedPaperAbstract","pdfUrl","pdfUrls","abstractWasTrimmed","paperAbstract","trimmed","substr","Math","min","lastIndexOf","elevation","mb","padding","position","float","clear","marginBottom","title","pdfIcon","cursor","window","doiUrl","doiIcon","s2Url","s2Icon","verticalAlign","inCitations","Modal","stopPropagation","top","left","maxWidth","backgroundColor","boxShadow","paddingTop","paddingBottom","outline","flexDirection","newValue","queryPublications","then","catch","Divider","overflow","paddingLeft","paddingRight","generateColorTuple","id","rng","seedrandom","xor4096","tinyColor","mix","fromRatio","r","g","b","saturate","toHexString","commonPathStyle","stroke","fillRule","fillOpacity","Citrus","color1","color2","xmlns","xlink","viewBox","version","fill","d","shortName","firstAuthorLastName","split","pop","shouldHighlightSearchButton","searchConfigExpanded","setSearchConfigExpanded","seedPapers","setSeedPapers","setMaxPublicationCount","history","useHistory","seedPaperSearchOpen","setSeedPaperSearchOpen","Object","keys","zIndex","setTimeout","push","join","fontFamily","Slider","event","getAriaValueText","valueLabelDisplay","step","max","maxHeight","entries","paper","Home","Container","right","hasOwnProperty","SEARCH_QUERY","SEARCH_RESULT","SEARCH_ERROR","searchResult","result","type","citrusPaths","ForceGraph","props","currentGraphHash","currentGraph","links","nodes","timeScale","yAxisG","zoom","simulation","selectedNode","clippingToTimeline","gMain","gDraw","resizeCallback","resize","resizeTimeout","seedPaperNodes","this","svg","node","getBoundingClientRect","graphWidth","selectAll","remove","append","attr","classed","d3","domain","graph","maxYear","range","yAxis","createTimeAxis","call","on","newTimeScale","rescaleX","zoomed","addEventListener","shouldComponentUpdate","clipNodesToTimeline","selectedPublication","onPublicationSelected","graphHash","selectedPublicationId","each","n","setSelectedNode","parse","redrawGraph","initXCoordinates","stop","allLinks","citations","concat","similarities","data","enter","l","source","includes","SEED_PAPER_NODE_WIDTH","relevanceScore","dragstarted","dragged","dragended","filter","parent","group","path","appendCitrusPaths","text","force","distance","strength","iterations","selectedId","x","y","dy","dx","sqrt","pow","s","active","alphaTarget","restart","fx","fy","savedFx","removeEventListener","clearTimeout","doResize","shouldClip","initXTransform","initYTransform","translate","scale","alpha","i","Component","allNodes","ticks","tickFormat","fullYear","floor","Legend","showingLegend","shouldShowLegend","onMouseEnter","onMouseLeave","bottom","Card","CardContent","class","gridTemplateColumns","gridTemplateRows","columnGap","to","getCiteKey","fallback","generateBibTexEntry","citeKey","doiEntry","doi","journalName","HtmlTooltip","styled","Tooltip","popper","theme","tooltipClasses","tooltip","onBrowseReferences","onBrowseCitations","showAllAuthors","setShowAllAuthors","publicationById","journal","yearAndJournal","addSeedDisabled","placement","flexShrink","outCitations","navigator","clipboard","writeText","fileName","blob","Blob","FileSaver","saveAs","saveFile","generateBibTexFilename","bibTexIcon","fontWeight","BrowseModalTypes","publicationShortName","setSelectedPublicationId","fetchCitations","fetchReferences","regex","RegExp","test","allAuthors","Tab","isClosable","isSelected","isPinned","onDoubleClick","lastClick","clickInFlight","Date","now","fontStyle","borderStyle","borderWidth","boxSizing","borderColor","userSelect","WebkitUserSelect","MozUserSelect","msUserSelect","tabTitle","Boolean","Cookies","get","showHelpTab","setShowHelpTab","helpTabSelected","setHelpTabSelected","browseModalState","setBrowseModalState","entry","tabList","remaining","removeTab","publicationsCopy","forEach","pinTab","set","mr","mt","flexWrap","pinTabAnimation","timeLineEnabled","setTimeLineEnabled","maxRelevancePublication","detailExpanded","setDetailExpanded","random","graphForceUpdateProp","graphForceUpdate","Fragment","fakePropForForceUpdate","transition","Switch","checked","location","useLocation","params","URLSearchParams","parseInt","isNaN","queryString","seedsString","papers","createTheme","typography","App","ThemeProvider","initialState","combineReducers","action","actions","watcherSaga","transformMockData","put","minYear","getFullYear","maxRelevanceScore","citationCount","randomPublication","similarPublications","similaritiesCount","takeLatest","sagas","searchSaga","sagaMiddleware","createSagaMiddleware","composed","applyMiddleware","store","createStore","reducer","middleware","run","hostname","match","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.0a386f85.chunk.js","sourcesContent":["import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Input from \"@mui/material/Input\";\nimport Paper from \"@mui/material/Paper\";\nimport SearchIcon from \"@mui/icons-material/Search\";\nimport TuneIcon from '@mui/icons-material/Tune';\nimport '../css/searchbar.css'\n\nconst styles = {\n    root: {\n        height: 42,\n        display: \"flex\",\n        justifyContent: \"space-between\",\n    },\n    iconButton: {\n        color: '#aaa',\n        transform: \"scale(1, 1)\",\n        /*\n        transition: theme.transitions.create([\"transform\", \"color\"], {\n            duration: theme.transitions.duration.shorter,\n            easing: theme.transitions.easing.easeInOut,\n        }),*/\n    },\n    iconButtonHidden: {\n        transform: \"scale(0, 0)\",\n        \"& > $icon\": {\n            opacity: 0,\n        },\n    },\n    searchIconButton: {\n        marginRight: 4,\n    },\n    input: {\n        width: \"100%\",\n    },\n    searchContainer: {\n        margin: \"auto 16px\",\n        width: `calc(100% - ${0}px)`,\n    },\n};\n\n\nconst SearchBar = React.forwardRef(\n    (\n        {\n            cancelOnEscape,\n            className,\n            classes,\n            settingsIcon,\n            showSettingsButton,\n            highlightSettingsButton,\n            highlightSearchButton,\n            onClickSettings,\n            disabled,\n            onCancelSearch,\n            onRequestSearch,\n            searchIcon,\n            style,\n            ...inputProps\n        },\n        ref\n    ) => {\n        const inputRef = React.useRef();\n        const [value, setValue] = React.useState(inputProps.value);\n\n        React.useEffect(() => {\n            setValue(inputProps.value);\n        }, [inputProps.value]);\n\n        const handleFocus = React.useCallback(\n            (e) => {\n                if (inputProps.onFocus) {\n                    inputProps.onFocus(e);\n                }\n            },\n            [inputProps.onFocus]\n        );\n\n        const handleBlur = React.useCallback(\n            (e) => {\n                setValue((v) => v.trim());\n                if (inputProps.onBlur) {\n                    inputProps.onBlur(e);\n                }\n            },\n            [inputProps.onBlur]\n        );\n\n        const handleInput = React.useCallback(\n            (e) => {\n                setValue(e.target.value);\n                if (inputProps.onChange) {\n                    inputProps.onChange(e.target.value);\n                }\n            },\n            [inputProps.onChange]\n        );\n\n        const handleCancel = React.useCallback(() => {\n            setValue(\"\");\n            if (onCancelSearch) {\n                onCancelSearch();\n            }\n        }, [onCancelSearch]);\n\n        const handleRequestSearch = React.useCallback(() => {\n            if (onRequestSearch) {\n                onRequestSearch(value);\n            }\n        }, [onRequestSearch, value]);\n\n        const handleClickSettings = React.useCallback(() => {\n            if (onClickSettings) {\n                onClickSettings();\n            }\n        }, [onClickSettings]);\n\n        const handleKeyUp = React.useCallback(\n            (e) => {\n                if (e.charCode === 13 || e.key === \"Enter\") {\n                    handleRequestSearch();\n                } else if (\n                    cancelOnEscape &&\n                    (e.charCode === 27 || e.key === \"Escape\")\n                ) {\n                    handleCancel();\n                }\n                if (inputProps.onKeyUp) {\n                    inputProps.onKeyUp(e);\n                }\n            },\n            [handleRequestSearch, cancelOnEscape, handleCancel, inputProps.onKeyUp]\n        );\n\n        React.useImperativeHandle(ref, () => ({\n            focus: () => {\n                inputRef.current.focus();\n            },\n            blur: () => {\n                inputRef.current.blur();\n            },\n        }));\n\n        return (\n            <Paper style={{ ...style, ...styles.root }}>\n                <div style={styles.searchContainer}>\n                    <Input\n                        {...inputProps}\n                        inputRef={inputRef}\n                        onBlur={handleBlur}\n                        value={value}\n                        onChange={handleInput}\n                        onKeyUp={handleKeyUp}\n                        onFocus={handleFocus}\n                        fullWidth\n                        style={styles.input}\n                        disableUnderline\n                        disabled={disabled}\n                    />\n                </div>\n                <IconButton\n                    onClick={handleRequestSearch}\n                    style={{ ...styles.iconButton, ...styles.searchIconButton }}\n                    disabled={disabled}\n                >\n                    {React.cloneElement(searchIcon, {\n                        style: styles.icon,\n                        className: highlightSearchButton ? 'pulseElement' : '',\n                        color: 'action'\n                    })}\n                </IconButton>\n                {showSettingsButton && (\n                    <IconButton\n                        onClick={handleClickSettings}\n                        style={styles.iconButton}\n                        disabled={disabled}\n                    >\n                        {React.cloneElement(settingsIcon, {\n                            color: highlightSettingsButton ? 'primary' : 'action'\n                        })}\n                    </IconButton>\n                )}\n            </Paper>\n        );\n    }\n);\n\nSearchBar.defaultProps = {\n    className: \"\",\n    showSettingsButton: true,\n    highlightSettingsButton: false,\n    highlightSearchButton: false,\n    settingsIcon: <TuneIcon />,\n    disabled: false,\n    placeholder: \"Search\",\n    searchIcon: <SearchIcon />,\n    style: null,\n    value: \"\",\n};\n\nSearchBar.propTypes = {\n    /** Whether to clear search on escape */\n    cancelOnEscape: PropTypes.bool,\n    /** Override or extend the styles applied to the component. */\n    classes: PropTypes.object,\n    /** Custom top-level class */\n    className: PropTypes.string,\n    /** Override the close icon. */\n    settingsIcon: PropTypes.node,\n    /** Disables text field. */\n    disabled: PropTypes.bool,\n    /** Fired when the search is cancelled. */\n    onCancelSearch: PropTypes.func,\n    /** Fired when the text value changes. */\n    onChange: PropTypes.func,\n    /** Fired when the search icon is clicked. */\n    onRequestSearch: PropTypes.func,\n    /** Sets placeholder text for the embedded text field. */\n    placeholder: PropTypes.string,\n    /** Override the search icon. */\n    searchIcon: PropTypes.node,\n    /** Override the inline-styles of the root element. */\n    style: PropTypes.object,\n    /** The value of the text field. */\n    value: PropTypes.string,\n};\n\nexport default SearchBar;","export default __webpack_public_path__ + \"static/media/logo.ef8d003f.svg\";","import React from 'react';\nimport logo from '../assets/logo.svg';\n\nfunction LoadingIndicator({ size, style }) {\n\n    return (\n        <div style={{ ...style, textAlign: 'center' }}>\n            <img style={{\n                width: size,\n                height: size,\n                animation: `spin 1.4s ease-in-out infinite`\n            }} src={logo} alt='citrus logo' />\n        </div>\n    );\n}\n\nexport default LoadingIndicator;","export default __webpack_public_path__ + \"static/media/s2.3a3cb6bd.png\";","export default __webpack_public_path__ + \"static/media/doi.14cfddf5.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAW7AAAFuwHJqm8tAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAexQTFRF////4ldM4ldM4ldM4ldMyEM3yEM4yEQ4yEQ4yEQ4yEQ54ldMyEQ5yEQ5yEU44ldMyEU4yEU4yUU4ykQ4ykQ5ykU5ykU5ykU5ykU5ykY6ykY6ykY6zEc6zEc7zEc7zEc74ldM4ldMtTYptzcruToswj8zwkA0y0c6zEY7zkk921JH4ldM4lhN41pQ41tQ41xR41xS411S415T419U42BV5GBW5GJX5GJY5GNZ5GVb5WZc5Wdd5Whe5Wlf5Wth5mxi5m1k5m9l5m9m53Vs6Hhv6Hty6Hxz6X116X516YF56YJ66oR86oV964iB642G7I6H7JGK7JKK7ZeQ7ZmS7pqU7puU7p2W7p2X7p6Y7p+Z76Gb76Kc8Kag8Kei8Kul8aum8ayn8a2n8a+q8bCr8bGr8rGs8rKt8rOu8rWw8rax8rey87ey87iz87m087q187q287y39L259MC89MK+9cXB9cbC9sjF9snF9srG9srH9svI9szI9s3K9s7K987L99DM99DN99HO+NbT+NnW+drY+dvY+d3a+d/d+uHf+uPh+uXj++bk++fl++jm++nn++no++rp++vp/Ovq/O3r/O3s/O7t/O/t/O/u/PDv/PHw/fLx/fTz/fT0/fX0/vr6/vv7/vz7//z8//7+////v4mUtQAAACJ0Uk5TAAEmcICwsLGys7OztLW1tba4uLi5uru8vb6/wMDBwsPm9vQJaUIAAAMOSURBVHja7dvpU9NAGAfgpq1nVbwVz3ZVFFYURRGtJ8UT79taxZMiKsUDUDyq4o2iqLViQaH5R82uJGmamjSd3ew48/4+dd/Z6fvMbo72w3o8OfH6A0HMIOM8JUXyhTCboPEl9S/DrIJKEvgwQwCa4Li/N8QUgCY6BfgxWwCa5BAQYA1wKggyB6DJjgCYPQBNEQ1wJOACQFNFA9A00QA0XTSgaAE3AJohGoBmigagWaIBaLZoAJojGlCEgDMAzRUNsBVwB6B5ogE2AhcAaL5ogKXAFQAqFw1A5ZIbgOUWggWSC4AKVIKAJWClFQAtlLgDqpZZChZJvAG40hKAFku8AXiFcwFbAK603oUlEm8ArlpVYXU3LuUOsAsAAAAAAAAAAAAAAAD+L8D2ttQwSV/XxYha23ylf4jkSzJ+fHeNPjccTw//zZMIM0C7rGX02liz63JO0mfXqHMTevUZM0Aqt9nbdbT2TTbk1Rbz3EFmgF+GXq0FarL8ud409x5TwPtoNNr6iXxvdq/W6GlPz4vMWLuEPvddJ8npGqYAuqEbXpNWLRqgjnzadilLXY3a3GbWd4EGwCdIq+dGAMZNdBVernYBUD9Crvl8AI7STWhyCzBoAqz9SkbnXQCc1O5vAwDHyegOf0DdG9Loqhlwhox6uQL6YrFYgq50dp8ZcIiMMmq966iSCGOAnnZsBhyksmrD3IecAB9rCwBOkdGHvLm7eACyNzfiAoAWMuo2zs2GmQJGlRfswKPLjQaUCqimz+hmA2CkjcdtmLcqKoA+IOUjav3ufiVbsXuAPT/o23eTCw+iQoBw9DddgGPYfYDyOk6qv0ySWAAgJ0M7OALSypd25tUyxv4P1GuOXA5R1oDb2g7reZzb/vthrd6hDBtYA3beT91Yn1cL3+qnP75/9nacO1Cr1xu6By7APyMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACUBgu72D3I98llEAlwPvRYRP9djv/YJebkefLaPj+/Rb9uUSXwPv9utv+9fpyxYHf+3vP8CfsP+/wEtLRb0bq9JTwAAAABJRU5ErkJggg==\"","\n\n\nconst baseUrl = process.env.REACT_APP_BACKEND_URL\n\nexport async function search(query) {\n    const requestOptions = {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n            textQuery: query.textQuery,\n            seedPaperIds: query.seedPaperIds,\n            limit: query.maxPublicationCount\n        })\n    };\n    const response = await fetch(`${baseUrl}/search`, requestOptions)\n    const parsedResponse = await response.json()\n    return parsedResponse\n}\n\nexport async function queryPublications(textQuery) {\n    const requestOptions = { method: 'GET' };\n    const response = await fetch(`${baseUrl}/publications?q=${encodeURIComponent(textQuery)}`, requestOptions)\n    const parsedResponse = await response.json()\n    return parsedResponse\n}\n\nexport async function fetchCitations(publicationId) {\n    const requestOptions = { method: 'GET' };\n    const response = await fetch(`${baseUrl}/publications/${publicationId}/citing`, requestOptions)\n    const parsedResponse = await response.json()\n    return parsedResponse\n}\n\n\nexport async function fetchReferences(publicationId) {\n    const requestOptions = { method: 'GET' };\n    const response = await fetch(`${baseUrl}/publications/${publicationId}/referenced`, requestOptions)\n    const parsedResponse = await response.json()\n    return parsedResponse\n}","import React, { useState, useEffect, useRef } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport Modal from '@mui/material/Modal';\nimport Divider from '@mui/material/Divider';\nimport IconButton from '@mui/material/IconButton';\nimport Paper from '@mui/material/Paper';\nimport Button from '@mui/material/Button';\nimport CloseIcon from '@mui/icons-material/Close';\nimport AddIcon from '@mui/icons-material/Add';\nimport SearchBar from '../common/SearchBar';\nimport LoadingIndicator from '../common/LoadingIndicator';\nimport s2Icon from '../assets/s2.png'\nimport doiIcon from '../assets/doi.svg'\nimport pdfIcon from '../assets/pdf.png'\nimport { queryPublications } from '../../services/api'\n\n\nfunction SeedPaperSearchModal({ open, onClose, addSeedPaper, addSeedPaperDisabled }) {\n\n    const mounted = useRef(false);\n    const [loading, setLoading] = useState(false)\n    const [error, setError] = useState(null)\n    const [publications, setPublications] = useState([])\n    const [searchQuery, setSearchQuery] = useState('')\n    const [expandedSet, setExpandedSet] = useState(new Set())\n    const [showAllAuthorsSet, setShowAllAuthorsSet] = useState(new Set())\n\n    useEffect(() => {\n        mounted.current = true;\n        return () => { mounted.current = false; };\n    }, [])\n\n    function onError(err) {\n        console.log(err)\n        if (mounted.current) {\n            setError(err)\n            setLoading(false)\n        }\n    }\n\n    function onResult(response) {\n        if (mounted.current) {\n            setPublications(response)\n            setLoading(false)\n        }\n    }\n\n    const publicationList = publications.map((publication) => {\n        const year = (publication.year === 0 ? '' : `(${publication.year})`)\n\n        let authors\n        if (!publication.authors?.length) {\n            authors = ''\n        } else if (publication.authors.length <= 2 || showAllAuthorsSet.has(publication.Id)) {\n            authors = publication.authors.map((author) => author.name).reduce((prev, next) => (prev + ', ' + next))\n        } else {\n            const firstAuthors = publication.authors.slice(0, 2).map((author) => author.name).reduce((prev, next) => (prev + ', ' + next))\n            authors =\n                <div style={{ display: 'inline-block' }}>\n                    {firstAuthors}\n                    <Button\n                        variant=\"text\"\n                        style={{ textTransform: 'none', fontSize: 16, marginTop: -4, marginLeft: -8 }}\n                        onClick={() => {\n                            const newSet = new Set(showAllAuthorsSet)\n                            newSet.add(publication.Id)\n                            setShowAllAuthorsSet(newSet)\n                        }}\n                        sx={{ p: 0, m: 0 }}\n                    >\n                        et al.\n                    </Button>\n                </div>\n        }\n\n        const pdfUrl = publication.pdfUrls.length > 0 ? publication.pdfUrls[0] : ''\n\n        const maxAbstractChars = 300\n        let trimmedPaperAbstract;\n        let abstractWasTrimmed = false;\n        if (publication.paperAbstract) {\n            const trimmed = publication.paperAbstract.substr(0, maxAbstractChars);\n            if (publication.paperAbstract.length > trimmed.length) {\n                abstractWasTrimmed = true\n            }\n            // cut off at a word boundary\n            trimmedPaperAbstract = trimmed.substr(0, Math.min(trimmed.length, trimmed.lastIndexOf(\" \"))) + ' '\n        }\n\n        return (\n            <Paper elevation={3} sx={{ mb: 1 }} key={publication.Id}>\n                <div style={{ padding: 16, position: 'relative' }}>\n                    <IconButton\n                        color=\"primary\"\n                        aria-label=\"close\"\n                        sx={{ p: 0, m: 0, float: 'right', clear: 'right' }}\n                        disabled={addSeedPaperDisabled(publication)}\n                        onClick={() => addSeedPaper(publication)} >\n                        <AddIcon />\n                    </IconButton>\n                    <div style={{ marginBottom: 8, fontSize: 18 }}>{publication.title}</div>\n                    <div style={{ marginBottom: 4, color: 'grey' }}>\n                        <div style={{ display: 'inline-block', marginTop: 2, marginRight: 12 }}>\n                            {pdfUrl && (\n                                <img\n                                    src={pdfIcon}\n                                    alt=\"pdf icon\"\n                                    style={{ width: 18, marginRight: 8, cursor: 'pointer' }}\n                                    onClick={() => window.open(pdfUrl, '_newtab')}\n                                />\n                            )}\n                            {publication.doiUrl && (\n                                <img\n                                    src={doiIcon}\n                                    alt=\"doi icon\"\n                                    style={{ width: 18, marginRight: 4, cursor: 'pointer' }}\n                                    onClick={() => window.open(publication.doiUrl, '_newtab')}\n                                />\n                            )}\n                            {publication.s2Url && (\n                                <img\n                                    src={s2Icon}\n                                    alt=\"semantic scholar icon\"\n                                    style={{ width: 22, height: 18, cursor: 'pointer' }}\n                                    onClick={() => window.open(publication.s2Url, '_newtab')}\n                                />\n                            )}\n                        </div>\n                        <div style={{ display: 'inline-block', verticalAlign: 'top' }}>\n                            {authors} <span>{year}</span>\n                        </div>\n                    </div>\n                    <div style={{ display: 'inline-block', marginBottom: 8, color: 'grey', fontSize: 14 }}>{`${publication.inCitations.length} citations`}</div>\n                    {publication.paperAbstract && (\n                        (expandedSet.has(publication.Id) || !abstractWasTrimmed) ? (<div style={{ textAlign: 'justify' }}>{publication.paperAbstract}</div>) : (\n                            <div style={{ textAlign: 'justify' }}>{trimmedPaperAbstract}\n                                <span><Button\n                                    variant=\"text\"\n                                    style={{ textTransform: 'none', fontSize: 16, marginTop: -4 }}\n                                    onClick={() => {\n                                        const newSet = new Set(expandedSet)\n                                        newSet.add(publication.Id)\n                                        setExpandedSet(newSet)\n                                    }}\n                                    sx={{ p: 0, m: 0, color: '#888' }}\n                                >\n                                    Read more\n                                </Button></span>\n                            </div>\n                        )\n                    )}\n                </div>\n            </Paper >\n        )\n    })\n\n    return (\n        <Modal\n            open={open}\n            onClose={onClose}\n        >\n            <div\n                onClick={(e) => e.stopPropagation()}\n                style={{\n                    position: 'absolute',\n                    top: '50%',\n                    left: '50%',\n                    transform: 'translate(-50%, -50%)',\n                    width: '80%',\n                    maxWidth: 800,\n                    height: '80%',\n                    backgroundColor: '#ffffff',\n                    boxShadow: 24,\n                    padding: 32,\n                    paddingTop: 24,\n                    paddingBottom: 0,\n                    outline: 'none',\n                    display: 'flex',\n                    flexDirection: 'column'\n                }}>\n                <div>\n                    <IconButton\n                        color=\"primary\"\n                        aria-label=\"close\"\n                        sx={{ p: 0, m: 0, float: 'right', clear: 'right' }}\n                        onClick={() => onClose()} >\n                        <CloseIcon />\n                    </IconButton>\n                    <div style={{ marginBottom: 4, fontSize: 18 }}>{'Add Seed Publications'}</div>\n                    <div style={{ display: 'flex' }}>\n                        <SearchBar\n                            value={searchQuery}\n                            onChange={(newValue) => setSearchQuery(newValue)}\n                            onRequestSearch={() => {\n                                if (searchQuery) {\n                                    setLoading(true)\n                                    setError(null)\n                                    setShowAllAuthorsSet(new Set())\n                                    setExpandedSet(new Set())\n                                    queryPublications(searchQuery)\n                                        .then(onResult)\n                                        .catch(onError)\n                                }\n                            }}\n                            disabled={loading}\n                            showSettingsButton={false}\n                            placeholder={'Search by title, doi, authors'}\n                            style={{\n                                marginTop: 12,\n                                marginBottom: 12,\n                                width: '70%',\n                                maxWidth: 540,\n                            }}\n                        />\n                    </div>\n                    <Divider />\n                </div>\n                {loading ? <LoadingIndicator size={100} style={{ marginTop: 200 }} /> : (\n                    error ?\n                        <div>\n                            <div style={{ textAlign: \"center\", marginTop: 200, fontSize: 42 }}></div>\n                            <div style={{ textAlign: \"center\", color: 'grey' }}>\n                                {'Something went wrong. Trying again may help.'}\n                            </div>\n                        </div> : (\n                            publications.length === 0 ? (\n                                <div>\n                                    <div style={{ textAlign: \"center\", color: 'grey', marginTop: 200 }}>\n                                        {'No publications found.'}\n                                    </div>\n                                </div>) :\n                                (<div style={{\n                                    overflow: 'scroll',\n                                    paddingTop: 4,\n                                    paddingLeft: 4,\n                                    paddingRight: 4\n                                }}\n                                >\n                                    {publicationList}\n                                </div>))\n                )}\n            </div>\n        </Modal>\n    );\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(SeedPaperSearchModal);","import tinyColor from 'tinycolor2'\nimport seedrandom from 'seedrandom'\n\n\nexport default function generateColorTuple(id) {\n    const rng = seedrandom.xor4096(id)\n    const color1 = tinyColor.mix(tinyColor.fromRatio({r: rng(), g: rng(), b: rng()}).saturate(10), tinyColor('#fff'), 30).toHexString()\n    const color2 = tinyColor.mix(tinyColor.fromRatio({r: rng(), g: rng(), b: rng()}).saturate(10), tinyColor('#fff'), 30).toHexString()\n    return [color1, color2]\n}","\n\nconst commonPathStyle = {\n    stroke: 'none',\n    fillRule: 'evenodd',\n    fillOpacity: '1'\n}\n\nexport default function Citrus({ color1, color2, width }) {\n    return (\n        <svg xmlns=\"http://www.w3.org/2000/svg\" xlink=\"http://www.w3.org/1999/xlink\" width={width} height={width} viewBox=\"0 0 1402 1402\" version=\"1.1\">\n            <g id=\"surface1\">\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 701.5 1401.5 C 315.515625 1401.5 1.5 1087.480469 1.5 701.5 C 1.5 315.519531 315.515625 1.5 701.5 1.5 C 1087.480469 1.5 1401.5 315.519531 1401.5 701.5 C 1401.5 1087.480469 1087.480469 1401.5 701.5 1401.5 Z M 701.5 45.25 C 339.644531 45.25 45.25 339.640625 45.25 701.5 C 45.25 1063.359375 339.644531 1357.75 701.5 1357.75 C 1063.359375 1357.75 1357.75 1063.359375 1357.75 701.5 C 1357.75 339.640625 1063.359375 45.25 701.5 45.25 \" />\n                <path style={{...commonPathStyle, fill: color2}} d=\"M 1281.378906 678.109375 C 1272.261719 681.609375 779.890625 678.695313 779.890625 678.695313 C 779.890625 678.695313 1129.769531 346.019531 1169.929688 351.261719 C 1210.101563 356.5 1256 428.660156 1283.371094 494.328125 C 1310.761719 559.996094 1303.28125 641.429688 1297.808594 658.902344 C 1292.339844 676.367188 1281.378906 678.109375 1281.378906 678.109375 \" />\n                <path style={{...commonPathStyle, fill: color2}} d=\"M 736.140625 646.578125 C 736.140625 646.578125 725.789063 113.96875 766.953125 109.96875 C 809.292969 93.601563 918.199219 124.550781 1000.390625 167.550781 C 1078.691406 208.539063 1129.671875 246.058594 1122.359375 289.738281 C 1115.050781 333.449219 736.140625 646.578125 736.140625 646.578125 \" />\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 624.851563 673.835938 C 624.851563 673.835938 288.417969 359.160156 239.324219 352.589844 C 195 344.230469 149.390625 427.015625 123.777344 498.898438 C 96.65625 574.84375 84.128906 645.679688 133.5625 667.128906 C 192.285156 690.519531 624.851563 673.835938 624.851563 673.835938 \" />\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 677.082031 646.578125 C 677.082031 646.578125 694.792969 143.601563 672.320313 113.269531 C 630.308594 56.460938 258.722656 193.550781 294.941406 289.71875 C 323.269531 364.871094 677.082031 646.578125 677.082031 646.578125 \" />\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 121.621094 724.914063 C 130.742188 721.410156 624.851563 731.023438 624.851563 731.023438 C 624.851563 731.023438 273.21875 1057.011719 233.066406 1051.761719 C 192.894531 1046.519531 147 974.339844 119.621094 908.691406 C 92.234375 843.003906 99.703125 761.601563 105.191406 744.097656 C 110.660156 726.644531 121.621094 724.914063 121.621094 724.914063 \" />\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 668.6875 756.421875 C 668.6875 756.421875 677.210938 1289.011719 636.046875 1293.03125 C 593.707031 1309.390625 484.777344 1278.449219 402.609375 1235.429688 C 324.304688 1194.460938 273.335938 1156.941406 280.621094 1113.238281 C 287.945313 1069.550781 668.6875 756.421875 668.6875 756.421875 \" />\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 779.890625 725.488281 C 779.890625 725.488281 1114.578125 1043.808594 1163.671875 1050.390625 C 1208 1058.769531 1253.609375 975.980469 1279.21875 904.078125 C 1306.328125 828.15625 1318.871094 757.320313 1269.421875 735.871094 C 1210.730469 712.492188 779.890625 725.488281 779.890625 725.488281 \" />\n                <path style={{...commonPathStyle, fill: color1}} d=\"M 734.976563 756.421875 C 734.976563 756.421875 708.207031 1259.378906 730.691406 1289.710938 C 772.699219 1346.511719 1144.28125 1209.429688 1108.070313 1113.28125 C 1079.738281 1038.128906 734.976563 756.421875 734.976563 756.421875 \" />\n            </g>\n        </svg>\n    )\n}","import React, { useState } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport Paper from \"@mui/material/Paper\";\nimport IconButton from \"@mui/material/IconButton\";\nimport Slider from '@mui/material/Slider';\nimport SearchBar from '../common/SearchBar';\nimport AddIcon from '@mui/icons-material/Add';\nimport CloseIcon from '@mui/icons-material/Close';\nimport Divider from '@mui/material/Divider';\nimport { useHistory } from 'react-router-dom'\nimport SeedPaperSearchModal from './SeedPaperSearchModal'\nimport { MAX_SEED_PAPER_COUNT } from '../constants/constants'\nimport generateColorTuple from '../constants/colors'\nimport Citrus from '../common/Citrus'\n\n\nfunction shortName(publication) {\n    const year = (publication.year === 0 ? '' : publication.year)\n    let firstAuthorLastName;\n    if (!publication.authors?.length) {\n        firstAuthorLastName = ''\n    } else {\n        firstAuthorLastName = publication.authors[0].name.split(' ').pop()\n    }\n\n    if (year && firstAuthorLastName) {\n        return `${firstAuthorLastName}, ${year}`\n    } else if (firstAuthorLastName) {\n        return firstAuthorLastName\n    } else {\n        return ''\n    }\n}\n\nfunction SearchContainer({\n    style,\n    search,\n    searchQuery,\n    setSearchQuery,\n    shouldHighlightSearchButton,\n    searchConfigExpanded,\n    setSearchConfigExpanded,\n    seedPapers,\n    setSeedPapers,\n    maxPublicationCount,\n    setMaxPublicationCount,\n    addSeedPaper,\n    addSeedPaperDisabled\n}) {\n    const history = useHistory()\n    const [seedPaperSearchOpen, setSeedPaperSearchOpen] = useState(false)\n\n    const seedPaperIds = Object.keys(seedPapers)\n\n    return (\n        <div onClick={() => searchConfigExpanded && !seedPaperSearchOpen && setSearchConfigExpanded(false)} style={{\n            position: 'absolute',\n            width: '60%',\n            top: 4,\n            left: '0',\n            zIndex: 2,\n            ...style\n        }}>\n            <SeedPaperSearchModal\n                open={seedPaperSearchOpen}\n                onClose={() => {\n                    setSeedPaperSearchOpen(false)\n                    setTimeout(() => setSearchConfigExpanded(true))\n                }}\n                addSeedPaper={addSeedPaper}\n                addSeedPaperDisabled={addSeedPaperDisabled}\n            />\n            <SearchBar\n                disabled={search.loading}\n                value={searchQuery}\n                highlightSettingsButton={searchConfigExpanded}\n                highlightSearchButton={shouldHighlightSearchButton()}\n                onClickSettings={() => setSearchConfigExpanded(!searchConfigExpanded)}\n                onChange={(newValue) => setSearchQuery(newValue)}\n                onRequestSearch={() => {\n                    if (searchQuery || seedPaperIds.length) {\n                        history.push(`/search?q=${encodeURIComponent(searchQuery)}&s=${seedPaperIds.join(',')}&l=${maxPublicationCount}`)\n                    }\n                }}\n                placeholder={'Search for a research area, publication or author'}\n                style={{\n                    maxWidth: 500,\n                    margin: '0 auto'\n                }}\n            />\n            {searchConfigExpanded && (\n                <Paper\n                    sx={{\n                        margin: '8px auto'\n                    }}\n                    style={{ padding: 12, paddingTop: 20, maxWidth: 600 }}\n                    elevation={3}\n                    onClick={(e) => {\n                        e.stopPropagation()\n                    }}\n                >\n                    <div>\n                        <div style={{ fontFamily: 'Poppins' }}>Max number of publications</div>\n                        <Divider style={{ marginTop: 4, marginBottom: 12 }} />\n                        <Slider\n                            aria-label=\"Max number of publications\"\n                            value={maxPublicationCount}\n                            onChange={(event) => setMaxPublicationCount(event.target.value)}\n                            getAriaValueText={() => maxPublicationCount}\n                            valueLabelDisplay=\"auto\"\n                            step={10}\n                            min={10}\n                            max={500}\n                        />\n                        <div style={{ fontFamily: 'Poppins', marginTop: 12 }}>\n                            Seed publications\n                                {seedPaperIds.length !== 0 &&\n                                <IconButton\n                                    color=\"primary\"\n                                    aria-label=\"add seed paper\"\n                                    sx={{ p: 0, float: 'right' }}\n                                    style={{ marginRight: 14 }}\n                                    onClick={() => setSeedPaperSearchOpen(true)}\n                                    disabled={seedPaperIds.length >= MAX_SEED_PAPER_COUNT}\n                                >\n                                    <AddIcon fontSize=\"medium\" />\n                                </IconButton>\n                            }\n                        </div>\n                        <Divider style={{ marginTop: 4, marginBottom: 12 }} />\n                        {seedPaperIds.length ? (\n                            <div style={{ maxHeight: 400, overflow: 'scroll' }}>{\n                                Object.entries(seedPapers).map(([id, paper]) => {\n                                    const [color1, color2] = generateColorTuple(paper.Id)\n                                    return (\n                                        <Paper key={paper.Id} sx={{ m: 1, p: 1, fontSize: 14 }} elevation={3}>\n                                            <IconButton\n                                                color=\"primary\"\n                                                aria-label=\"remove seed paper\"\n                                                sx={{ p: 0, m: 0, float: 'right', clear: 'right' }}\n                                                onClick={() => {\n                                                    delete seedPapers[paper.Id]\n                                                    setSeedPapers({ ...seedPapers })\n                                                }} >\n                                                <CloseIcon fontSize=\"small\" />\n                                            </IconButton>\n                                            <div style={{ marginBottom: 8 }}>{paper.title}</div>\n                                            <div style={{ display: 'inline-block', marginRight: 12 }}>\n                                                <Citrus color1={color1} color2={color2} width={28} />\n                                            </div>\n                                            <span style={{\n                                                display: 'inline-block',\n                                                verticalAlign: 'top',\n                                                marginTop: 4,\n                                                color: 'grey'\n                                            }}>{\n                                                    shortName(paper)}\n                                            </span>\n                                        </Paper>\n                                    )\n                                })\n                            }</div>\n                        ) : (\n                                <div>\n                                    <div style={{ fontSize: 15, textAlign: 'center', marginTop: 16 }}>\n                                        Seeds point Citrus toward your specific research domain.\n                                        </div>\n                                    <IconButton\n                                        style={{ margin: '0 auto', display: 'block' }}\n                                        color='primary'\n                                        onClick={() => setSeedPaperSearchOpen(true)}\n                                    >\n                                        <AddIcon color='primary' fontSize='large' />\n                                    </IconButton>\n                                </div>\n                            )}\n                    </div>\n                </Paper>\n            )}\n        </div>\n    )\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(SearchContainer);","export const MAX_SEED_PAPER_COUNT = 15","import React, { useState } from 'react';\nimport SearchContainer from './search/SearchContainer';\nimport logo from './assets/logo.svg';\nimport Container from '@mui/material/Container';\nimport Button from '@mui/material/Button';\nimport { MAX_SEED_PAPER_COUNT } from './constants/constants'\n\nfunction Home() {\n    const [searchQuery, setSearchQuery] = useState('')\n    const [seedPapers, setSeedPapers] = useState({})\n    const [maxPublicationCount, setMaxPublicationCount] = useState(100)\n    const [searchConfigExpanded, setSearchConfigExpanded] = useState(false)\n\n\n    const shouldHighlightSearchButton = () => {\n        return Object.keys(seedPapers).length\n    }\n\n    const addSeedPaper = (paper) => {\n        if (!seedPapers.hasOwnProperty(paper.Id)) {\n            setSeedPapers({\n                [paper.Id]: paper,\n                ...seedPapers\n            })\n        }\n    }\n\n    const addSeedPaperDisabled = (p) => {\n        return Object.keys(seedPapers).length >= MAX_SEED_PAPER_COUNT || seedPapers.hasOwnProperty(p.Id)\n    }\n\n    return (\n        <Container>\n            <div style={{\n                position: 'absolute',\n                maxWidth: 500,\n                top: 4,\n                right: 24,\n                zIndex: 2\n            }}>\n                <Button variant=\"text\" sx={{ width: 80, height: 36, fontFamily: 'Poppins', marginTop: 1 }}>About</Button>\n                <Button variant=\"text\" sx={{ width: 80, height: 36, fontFamily: 'Poppins', marginTop: 1 }}>Donate</Button>\n            </div>\n            <div>\n                <div style={{ textAlign: 'center', marginBottom: 24 }}>\n                    <img style={{\n                        width: 200,\n                        height: 200,\n                        marginTop: 100,\n                        marginBottom: 12\n                    }} src={logo} alt=\"citrus logo\" />\n                    <div style={{ color: 'rgb(49%,40%,58%)', fontSize: 42, fontFamily: 'Poppins' }}>\n                        citrus\n                    </div>\n                </div>\n                <SearchContainer\n                    style={{ position: 'static', margin: '0 auto' }}\n                    searchQuery={searchQuery}\n                    setSearchQuery={setSearchQuery}\n                    shouldHighlightSearchButton={shouldHighlightSearchButton}\n                    searchConfigExpanded={searchConfigExpanded}\n                    setSearchConfigExpanded={setSearchConfigExpanded}\n                    seedPapers={seedPapers}\n                    setSeedPapers={setSeedPapers}\n                    maxPublicationCount={maxPublicationCount}\n                    setMaxPublicationCount={setMaxPublicationCount}\n                    addSeedPaper={addSeedPaper}\n                    addSeedPaperDisabled={addSeedPaperDisabled}\n                />\n            </div>\n        </Container>\n    );\n}\n\nexport default Home;","export const SEARCH_QUERY = 'SEARCH_QUERY'\nexport const SEARCH_RESULT = 'SEARCH_RESULT'\nexport const SEARCH_ERROR = 'SEARCH_ERROR'\n\nexport function search(query) {\n    return {\n        type: SEARCH_QUERY,\n        query\n    }\n}\n\nexport function searchError(error) {\n    return {\n        type: SEARCH_ERROR,\n        error\n    }\n}\n\nexport function searchResult(result) {\n    return {\n        type: SEARCH_RESULT,\n        result\n    }\n}","import React, { Component } from 'react';\nimport '../css/graph.css'\nimport * as d3 from 'd3v4';\nimport generateColorTuple from '../constants/colors';\n\nconst alwaysEnabledConsole = console.log\n\nconst citrusPaths = [\n    { color: 0, d: 'M 701.5 1401.5 C 315.515625 1401.5 1.5 1087.480469 1.5 701.5 C 1.5 315.519531 315.515625 1.5 701.5 1.5 C 1087.480469 1.5 1401.5 315.519531 1401.5 701.5 C 1401.5 1087.480469 1087.480469 1401.5 701.5 1401.5 Z M 701.5 45.25 C 339.644531 45.25 45.25 339.640625 45.25 701.5 C 45.25 1063.359375 339.644531 1357.75 701.5 1357.75 C 1063.359375 1357.75 1357.75 1063.359375 1357.75 701.5 C 1357.75 339.640625 1063.359375 45.25 701.5 45.25' },\n    { color: 1, d: \"M 1281.378906 678.109375 C 1272.261719 681.609375 779.890625 678.695313 779.890625 678.695313 C 779.890625 678.695313 1129.769531 346.019531 1169.929688 351.261719 C 1210.101563 356.5 1256 428.660156 1283.371094 494.328125 C 1310.761719 559.996094 1303.28125 641.429688 1297.808594 658.902344 C 1292.339844 676.367188 1281.378906 678.109375 1281.378906 678.109375 \" },\n    { color: 1, d: \"M 736.140625 646.578125 C 736.140625 646.578125 725.789063 113.96875 766.953125 109.96875 C 809.292969 93.601563 918.199219 124.550781 1000.390625 167.550781 C 1078.691406 208.539063 1129.671875 246.058594 1122.359375 289.738281 C 1115.050781 333.449219 736.140625 646.578125 736.140625 646.578125 \" },\n    { color: 0, d: \"M 624.851563 673.835938 C 624.851563 673.835938 288.417969 359.160156 239.324219 352.589844 C 195 344.230469 149.390625 427.015625 123.777344 498.898438 C 96.65625 574.84375 84.128906 645.679688 133.5625 667.128906 C 192.285156 690.519531 624.851563 673.835938 624.851563 673.835938 \" },\n    { color: 0, d: \"M 677.082031 646.578125 C 677.082031 646.578125 694.792969 143.601563 672.320313 113.269531 C 630.308594 56.460938 258.722656 193.550781 294.941406 289.71875 C 323.269531 364.871094 677.082031 646.578125 677.082031 646.578125 \" },\n    { color: 0, d: \"M 121.621094 724.914063 C 130.742188 721.410156 624.851563 731.023438 624.851563 731.023438 C 624.851563 731.023438 273.21875 1057.011719 233.066406 1051.761719 C 192.894531 1046.519531 147 974.339844 119.621094 908.691406 C 92.234375 843.003906 99.703125 761.601563 105.191406 744.097656 C 110.660156 726.644531 121.621094 724.914063 121.621094 724.914063 \" },\n    { color: 0, d: \"M 668.6875 756.421875 C 668.6875 756.421875 677.210938 1289.011719 636.046875 1293.03125 C 593.707031 1309.390625 484.777344 1278.449219 402.609375 1235.429688 C 324.304688 1194.460938 273.335938 1156.941406 280.621094 1113.238281 C 287.945313 1069.550781 668.6875 756.421875 668.6875 756.421875 \" },\n    { color: 0, d: \"M 779.890625 725.488281 C 779.890625 725.488281 1114.578125 1043.808594 1163.671875 1050.390625 C 1208 1058.769531 1253.609375 975.980469 1279.21875 904.078125 C 1306.328125 828.15625 1318.871094 757.320313 1269.421875 735.871094 C 1210.730469 712.492188 779.890625 725.488281 779.890625 725.488281 \" },\n    { color: 0, d: \"M 734.976563 756.421875 C 734.976563 756.421875 708.207031 1259.378906 730.691406 1289.710938 C 772.699219 1346.511719 1144.28125 1209.429688 1108.070313 1113.28125 C 1079.738281 1038.128906 734.976563 756.421875 734.976563 756.421875 \" }\n]\n\nconst SEED_PAPER_NODE_WIDTH = 90\n\nexport default class ForceGraph extends Component {\n\n    constructor(props) {\n        super(props);\n        this.currentGraphHash = null\n        this.currentGraph = null\n        this.links = []\n        this.nodes = []\n        this.timeScale = null\n        this.yAxisG = null\n        this.zoom = null\n        this.simulation = null\n        this.selectedNode = null\n        this.clippingToTimeline = true\n        this.gMain = null\n        this.gDraw = null\n        this.width = 0\n        this.height = 0\n        this.resizeCallback = () => this.resize(this)\n        this.resizeTimeout = null\n        this.seedPaperIds = []\n        this.seedPaperNodes = []\n    }\n\n    componentDidMount() {\n        // init\n        this.width = this.svg.node().getBoundingClientRect().width * this.props.graphWidth;\n        this.height = this.svg.node().getBoundingClientRect().height;\n\n        // add defs\n        this.svg.selectAll('defs').remove();\n        this.svg.append('defs').append('marker')\n            .attr('id', 'arrowhead')\n            .attr('viewBox', '-0 -5 10 10')\n            .attr('refX', 10)\n            .attr('refY', 0)\n            .attr('orient', 'auto')\n            .attr('markerWidth', 4)\n            .attr('markerHeight', 4)\n            .attr('xoverflow', 'visible')\n            .append('svg:path')\n            .attr('d', 'M 0,-5 L 10 ,0 L 0,5')\n            .attr('fill', '#001182')\n            .style('stroke', 'none');\n\n        // remove any previous graphs\n        this.svg.selectAll('.g-main').remove();\n\n        this.gMain = this.svg.append('g')\n            .classed('g-main', true)\n\n        // add background\n        this.gMain.append('rect')\n            .classed('graph-background', true)\n            .attr('width', '100%')\n            .attr('height', '100%')\n\n        // add graph\n        this.gDraw = this.gMain.append('g')\n\n        // add Y axis\n        this.timeScale = d3.scaleLinear()\n            .domain([this.props.graph.maxYear, this.props.graph.maxYear - 30])\n            .range([this.width - 96, 96]);\n        const yAxis = createTimeAxis(this.timeScale, this.width)\n        this.yAxisG = this.gMain.append(\"g\")\n            .classed('y-axis', true)\n            .call(yAxis)\n            .attr(\"transform\", \"translate(\" + (0) + \",\" + (this.height - 60) + \")\");\n\n        // Add zoom\n        this.zoom = d3.zoom().on('zoom', () => zoomed(this.gDraw, this.timeScale, this.yAxisG));\n        function zoomed(gDraw, timeScale, yAxisG) {\n            gDraw.attr('transform', d3.event.transform);\n            const newTimeScale = d3.event.transform.rescaleX(timeScale);\n            yAxisG.call(createTimeAxis(newTimeScale))\n        }\n        this.gMain.call(this.zoom)\n\n        window.addEventListener('resize', this.resizeCallback)\n\n        this.shouldComponentUpdate(this.props)\n    }\n\n\n    shouldComponentUpdate({ graph, clipNodesToTimeline, selectedPublication, onPublicationSelected, graphWidth, seedPaperIds }) {\n        this.onPublicationSelected = onPublicationSelected\n        this.graphWidth = graphWidth\n\n        const width = this.svg.node().getBoundingClientRect().width * graphWidth;\n        const height = this.svg.node().getBoundingClientRect().height;\n\n        // TODO: more efficient update logic?\n        const graphHash = JSON.stringify(graph)\n        if (graphHash === this.currentGraphHash\n            && this.clippingToTimeline === clipNodesToTimeline\n            && this.selectedPublicationId === selectedPublication\n            && this.width === width\n            && this.height === height) {\n            return false;\n        } else if (graphHash === this.currentGraphHash) {\n            if (this.width !== width || this.height !== height) {\n                this.resize()\n            }\n\n            if (this.clippingToTimeline !== clipNodesToTimeline) {\n                this.clipNodesToTimeline(clipNodesToTimeline)\n            }\n\n            if (selectedPublication !== this.selectedPublicationId) {\n                this.selectedPublicationId = selectedPublication\n                let selectedNode;\n                this.nodes.each((n) => {\n                    if (n.Id === selectedPublication) {\n                        selectedNode = n\n                    }\n                })\n                setSelectedNode(selectedNode, this.nodes, this.links)\n            }\n\n            return false\n        }\n\n        this.currentGraphHash = graphHash\n        this.currentGraph = JSON.parse(graphHash)\n        this.clippingToTimeline = clipNodesToTimeline\n        this.selectedPublicationId = selectedPublication\n        this.seedPaperIds = seedPaperIds\n\n        return this.redrawGraph()\n    }\n\n    redrawGraph() {\n        this.initXCoordinates(this.currentGraph, this.clippingToTimeline)\n        this.clipNodesToTimeline(this.clippingToTimeline)\n\n        // remove possibly existing graph, stop possibly existing simulation\n        this.simulation?.stop()\n        this.gDraw.selectAll(\"g\").remove()\n\n        const allLinks = this.currentGraph.citations.concat(this.currentGraph.similarities)\n\n        // draw graph\n        // add links\n        this.links = this.gDraw.append(\"g\")\n            .attr(\"class\", \"link\")\n            .selectAll(\"line\")\n            .data(allLinks)\n            .enter().append(\"line\")\n            .attr('marker-end', (l) => {\n                if (l.type !== 'similar'\n                    && (this.selectedPublicationId === l.source || this.selectedPublicationId === l.target)) {\n                    return 'url(#arrowhead)'\n                }\n                return 'none'\n            })\n\n        // add nodes\n        this.nodes = this.gDraw.append(\"g\")\n            .attr(\"class\", \"node\")\n            .selectAll(\"circle\")\n            .data(this.currentGraph.publications)\n            .enter().append(\"circle\")\n            .attr(\"r\", (d) => {\n                if (this.seedPaperIds.includes(d.Id)) {\n                    return SEED_PAPER_NODE_WIDTH / 2\n                }\n                return d.relevanceScore * 30;\n            })\n            .attr(\"fill\", (d) => {\n                if (this.seedPaperIds.includes(d.Id)) {\n                    return '#ffffff'\n                }\n                return 'rgb(100%,72.068787%,0%)';\n            })\n            .call(d3.drag()\n                .on(\"start\", (d) => {\n                    this.onPublicationSelected(d.Id)\n                    dragstarted(d, this.links, this.nodes, this.simulation)\n                })\n                .on(\"drag\", dragged)\n                .on(\"end\", (d) => dragended(d, this.simulation, this.clippingToTimeline)));\n\n        // add seed paper svgs\n        this.seedPaperNodes = this.gDraw.append(\"g\")\n            .attr(\"class\", \"seed-paper\")\n            .selectAll(\"svg\")\n            .data(this.currentGraph.publications.filter((p) => this.seedPaperIds.includes(p.Id)))\n            .enter().append(\"svg\")\n            .attr(\"viewBox\", \"0 0 1402 1402\")\n            .attr(\"width\", SEED_PAPER_NODE_WIDTH)\n            .attr(\"height\", SEED_PAPER_NODE_WIDTH)\n            .call(d3.drag()\n                .on(\"start\", (d) => {\n                    this.onPublicationSelected(d.Id)\n                    dragstarted(d, this.links, this.nodes, this.simulation)\n                })\n                .on(\"drag\", dragged)\n                .on(\"end\", (d) => dragended(d, this.simulation, this.clippingToTimeline)));\n\n        appendCitrusPaths(this.seedPaperNodes)\n\n        function appendCitrusPaths(parent) {\n            const group = parent.append('g')\n            group.append(\"circle\")\n                .attr(\"r\", '50%')\n                .attr(\"cx\", '701')\n                .attr(\"cy\", '701')\n                .attr(\"fill\", 'white')\n            for (const path of citrusPaths) {\n                group.append('path')\n                    .attr('fill', function (d) { return generateColorTuple(d.Id)[path.color] })\n                    .attr('stroke', 'none')\n                    .attr('fill-rule', 'evenodd')\n                    .attr('fill-opacity', '1')\n                    .attr('d', path.d)\n            }\n        }\n\n        // add titles for mouseover blurbs\n        this.nodes.append(\"title\").text(function (d) { return d.title });\n\n        // create simulation\n        this.simulation = d3.forceSimulation()\n            .force(\"link\", d3.forceLink()\n                .id(function (d) { return d.Id; })\n                .distance(function (d) { return 100; }))\n            .force(\"charge\", d3.forceManyBody().strength(-600))\n            .force(\"x\", d3.forceX(this.width / 2).strength(0.05))\n            .force(\"y\", d3.forceY(this.height / 2).strength(0.05))\n            .force(\"collision\", d3.forceCollide(20).iterations(30))\n\n        this.simulation\n            .nodes(this.currentGraph.publications)\n            .on(\"tick\", () => ticked(this.links, this.nodes, this.seedPaperNodes, this.selectedPublicationId));\n\n        this.simulation.force(\"link\").links(allLinks);\n\n        // highlight selected node if present\n        if (this.selectedPublicationId) {\n            let selectedNode;\n            this.nodes.each((n) => {\n                if (n.Id === this.selectedPublicationId) {\n                    selectedNode = n\n                }\n            })\n            setSelectedNode(selectedNode, this.nodes, this.links)\n        }\n\n        function ticked(links, nodes, seedPaperNodes, selectedId) {\n            // update node and line positions at every step of \n            // the force simulation\n            links.attr(\"x1\", function (d) { return d.source.x; })\n                .attr(\"y1\", function (d) { return d.source.y; })\n                .attr(\"x2\", function (d) {\n                    if (d.target.Id === selectedId || d.source.Id === selectedId) {\n                        const dy = d.target.y - d.source.y\n                        const dx = d.target.x - d.source.x\n                        const distance = Math.sqrt(Math.pow(dy, 2) + Math.pow(dx, 2))\n                        const radius = d.target.relevanceScore * 30\n                        const s = (distance - radius) / Math.max(distance, 0.001)\n\n                        return d.source.x + s * dx\n                    }\n                    return d.target.x\n                })\n                .attr(\"y2\", function (d) {\n                    if (d.target.Id === selectedId || d.source.Id === selectedId) {\n                        const dy = d.target.y - d.source.y\n                        const dx = d.target.x - d.source.x\n                        const distance = Math.sqrt(Math.pow(dy, 2) + Math.pow(dx, 2))\n                        const radius = d.target.relevanceScore * 30\n                        const s = (distance - radius) / Math.max(distance, 0.001)\n\n                        return d.source.y + s * dy\n                    }\n                    return d.target.y\n                });\n\n            nodes.attr(\"cx\", function (d) { return d.x; })\n                .attr(\"cy\", function (d) { return d.y; });\n\n            seedPaperNodes.attr(\"x\", function (d) { return d.x - SEED_PAPER_NODE_WIDTH / 2; })\n                .attr(\"y\", function (d) { return d.y - SEED_PAPER_NODE_WIDTH / 2; })\n        }\n\n\n        function dragstarted(d, links, nodes, simulation) {\n            if (!d3.event.active) simulation.alphaTarget(0.1).restart();\n\n            setSelectedNode(d, nodes, links);\n\n            d.fx = d.x;\n            d.fy = d.y;\n        }\n\n        function dragged(d) {\n            d.fx += d3.event.dx;\n            d.fy += d3.event.dy;\n        }\n\n        function dragended(d, simulation, clippingToTimeline) {\n            if (!d3.event.active) simulation.alphaTarget(0);\n\n            d.fy = null;\n\n            if (clippingToTimeline) {\n                d.fx = d.savedFx;\n            } else {\n                d.fx = null;\n            }\n        }\n\n        return false\n    }\n\n    componentWillUnmount() {\n        this.simulation?.stop()\n        window.removeEventListener('resive', this.resizeCallback)\n        this.svg.selectAll('.g-main').remove();\n    }\n\n    render() {\n        return (\n            <svg\n                id=\"force-graph\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                ref={n => {\n                    this.svg = d3.select(n);\n                }}\n                style={{\n                    width: '100%',\n                    height: '100%',\n                    top: 0,\n                    left: 0,\n                    zIndex: -1000\n                }}\n            />\n        );\n    }\n\n    resize() {\n        if (this.resizeTimeout) {\n            clearTimeout(this.resizeTimeout)\n        }\n        this.resizeTimeout = setTimeout(() => this.doResize(), 300)\n    }\n\n    doResize() {\n        if (!this.svg.node()) return // this happens sometimes (?!)\n\n        this.width = this.svg.node().getBoundingClientRect().width * this.graphWidth;\n        this.height = this.svg.node().getBoundingClientRect().height;\n\n        this.yAxisG.remove()\n\n        // add Y axis\n        this.timeScale = d3.scaleLinear()\n            .domain([this.props.graph.maxYear, this.props.graph.maxYear - 30])\n            .range([this.width - 96, 96]);\n        const yAxis = createTimeAxis(this.timeScale)\n        this.yAxisG = this.gMain.append(\"g\")\n            .classed('y-axis', true)\n            .call(yAxis)\n            .attr(\"transform\", \"translate(\" + (0) + \",\" + (this.height - 60) + \")\");\n\n        this.initXCoordinates(this.currentGraph, this.clippingToTimeline)\n        this.clipNodesToTimeline(this.clippingToTimeline)\n    }\n\n\n    clipNodesToTimeline(shouldClip) {\n        if (shouldClip) {\n            this.clippingToTimeline = true;\n            const initXTransform = this.width * 0.55;\n            const initYTransform = this.height / 3;\n            this.gMain.call(this.zoom.transform, d3.zoomIdentity.translate(initXTransform, initYTransform).scale(0.35));\n            this.yAxisG.attr(\"opacity\", 1)\n            this.simulation?.stop();\n            if (this.nodes?.each) {\n                this.nodes.each(function (d) {\n                    d.fx = d.savedFx;\n                })\n            }\n            this.simulation?.alpha(1).restart();\n        } else {\n            this.clippingToTimeline = false;\n            const initXTransform = this.width / 3;\n            const initYTransform = this.height / 3;\n            this.gMain.call(this.zoom.transform, d3.zoomIdentity.translate(initXTransform, initYTransform).scale(0.35));\n            this.yAxisG.attr(\"opacity\", 0)\n            this.simulation?.stop();\n            if (this.nodes?.each) {\n                this.nodes.each(function (d) {\n                    d.fx = null;\n                })\n            }\n            this.simulation?.alpha(1).restart();\n        }\n    }\n\n    initXCoordinates(graph, clipNodesToTimeline) {\n        for (var i = 0; i < graph.publications.length; i++) {\n            if (clipNodesToTimeline) {\n                // Some publications have year = 0. Don't fix y for those\n                if (graph.publications[i].year) {\n                    graph.publications[i].savedFx = this.timeScale(graph.publications[i].year)\n                    graph.publications[i].fx = this.timeScale(graph.publications[i].year)\n                }\n            } else {\n                graph.publications[i].savedFx = this.timeScale(graph.publications[i].year)\n                graph.publications[i].fx = null\n            }\n        }\n    }\n}\n\nfunction setSelectedNode(node, allNodes, allLinks) {\n    allLinks.classed(\"citation\", false);\n    allLinks.classed(\"reference\", false);\n    allLinks.classed(\"similar\", false);\n    if (node) {\n        allNodes.classed(\"selected\", function (n) { return n.Id === node.Id });\n        allLinks.classed(\"citation\", function (l) { return l.type === 'cites' && l.target.Id === node.Id })\n        allLinks.classed(\"reference\", function (l) { return l.type === 'cites' && l.source.Id === node.Id })\n        allLinks.classed(\"similar\", function (l) { return l.type === 'similar' && (l.source.Id === node.Id || l.target.Id === node.Id) })\n    }\n    allLinks.attr('marker-end', (l) => {\n        if (l.type !== 'similar'\n            && (node?.Id === l.source.Id || node?.Id === l.target.Id)) {\n            return 'url(#arrowhead)'\n        }\n        return 'none'\n    })\n}\n\nfunction createTimeAxis(scale, width) {\n    return d3.axisBottom(scale)\n        .ticks(10)\n        .tickFormat(function (d) {\n            const fullYear = Math.floor(d)\n            if (fullYear % 10 === 0) {\n                return fullYear\n            } else {\n                return ''\n            }\n        })\n}\n\n\n\n","import React, { useState } from 'react';\nimport IconButton from '@mui/material/IconButton';\nimport Card from '@mui/material/Card';\nimport CardContent from '@mui/material/CardContent';\nimport InfoIcon from '@mui/icons-material/Info';\nimport { Link } from 'react-router-dom';\nimport Citrus from '../common/Citrus';\n\nfunction Legend() {\n    const [showingLegend, shouldShowLegend] = useState(false)\n\n    return (\n        <div\n            onMouseEnter={() => shouldShowLegend(true)}\n            onMouseLeave={() => shouldShowLegend(false)}\n            style={{\n                position: 'absolute',\n                bottom: 36,\n                left: 36\n            }}>\n            {showingLegend && (\n                <Card style={{ width: 340 }} sx={{ boxShadow: 3 }}>\n                    <CardContent>\n                        <div id=\"help-container\">\n                            <div class=\"legend-row\">\n                                <div id=\"regular-node\" class=\"node-symbol\"></div>\n                                <div>publication</div>\n                            </div>\n                            <div class=\"legend-row\">\n                                <div style={{\n                                    display: 'grid',\n                                    gridTemplateColumns: '50% 50%',\n                                    gridTemplateRows: '100%',\n                                    columnGap: '0%',\n                                    marginLeft: -6\n                                }}>\n                                    <div id=\"regular-node-small\" class=\"node-symbol\"></div>\n                                    <div id=\"regular-node-medium\" class=\"node-symbol\"></div>\n                                </div>\n                                <div>the size of a publication's node represents its {<Link to='/about'>relevance score</Link>}.</div>\n                            </div>\n                            <div class=\"legend-row\">\n                                <div id=\"selected-node\" class=\"node-symbol\"></div>\n                                <div>currently selected publication</div>\n                            </div>\n                            <div class=\"legend-row\">\n                                <Citrus color1={'rgb(100%,72.068787%,0%)'} color2={'rgb(49%,40%,58%)'} width={32} />\n                                <div>a {<Link to='/about'>seed publication</Link>}</div>\n                            </div>\n                            <div class=\"legend-row\">\n                                <div id=\"citation-or-reference\" class=\"link-symbol\"></div>\n                                <div>citation or reference</div>\n                            </div>\n                            <div class=\"legend-row\" style={{ marginBottom: 0 }}>\n                                <div id=\"similarity\" class=\"link-symbol\"></div>\n                                <div>connection between {<Link to='/about'>similar</Link>} publications</div>\n                            </div>\n                        </div>\n                    </CardContent>\n                </Card>\n            )}\n            <div>\n                <IconButton color=\"primary\" aria-label=\"help\">\n                    <InfoIcon />\n                </IconButton>\n            </div>\n        </div>\n    );\n}\n\nexport default Legend;","export default __webpack_public_path__ + \"static/media/bibtex.4c6e226f.png\";","\nfunction getCiteKey(publication, fallback='your_citation_key') {\n    const year = (publication.year === 0 ? '' : publication.year)\n    let firstAuthorLastName;\n    if (!publication.authors?.length) {\n        firstAuthorLastName = ''\n    } else {\n        firstAuthorLastName = publication.authors[0].name.split(' ').pop()\n    }\n\n    if (year && firstAuthorLastName) {\n        return `${firstAuthorLastName}${year}`\n    } else if (firstAuthorLastName) {\n        return firstAuthorLastName\n    } else {\n        return fallback\n    }\n}\n\nexport function generateBibTexFilename(publication) {\n    return getCiteKey(publication, 'publication') + '.bib'\n}\n\nexport function generateBibTexEntry(publication) {\n    const citeKey = getCiteKey(publication)\n    const author = publication.authors.map((author) => author.name).join(' and ')\n\n    const doiEntry = publication.doi ? `,\n    doi = {${publication.doi}}` : ''\n\n    return `@article{${citeKey},\n    author = {${author}},\n    title = {${publication.title}},\n    year = {${publication.year}},\n    journal = {${publication.journalName}}${doiEntry}\n}`\n}","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport Button from '@mui/material/Button';\nimport IconButton from '@mui/material/IconButton';\nimport AddIcon from '@mui/icons-material/Add';\nimport Citrus from '../common/Citrus'\nimport Tooltip, { tooltipClasses } from '@mui/material/Tooltip';\nimport { styled } from '@mui/material/styles';\nimport s2Icon from '../assets/s2.png'\nimport doiIcon from '../assets/doi.svg'\nimport pdfIcon from '../assets/pdf.png'\nimport bibTexIcon from '../assets/bibtex.png'\nimport { generateBibTexEntry, generateBibTexFilename } from '../../utils/bibtex'\nimport FileSaver from 'file-saver'\n\nconst HtmlTooltip = styled(({ className, ...props }) => (\n    <Tooltip {...props} classes={{ popper: className }} />\n))(({ theme }) => ({\n    [`& .${tooltipClasses.tooltip}`]: {\n        backgroundColor: 'transparent',\n    },\n}));\n\nfunction saveFile(fileName, text) {\n    const blob = new Blob([text], { type: \"text/plain;charset=utf-8\" });\n    FileSaver.saveAs(blob, fileName);\n}\n\nfunction PublicationDetail({\n    search,\n    selectedPublication,\n    onBrowseReferences,\n    onBrowseCitations,\n    addSeedPaper,\n    addSeedPaperDisabled\n}) {\n    const [showAllAuthors, setShowAllAuthors] = useState(false);\n\n    useEffect(() => {\n        setShowAllAuthors(false)\n    }, [selectedPublication]);\n\n    if (!selectedPublication) {\n        return null;\n    }\n\n    const publication = search.result.publicationById[selectedPublication]\n\n    const year = (publication.year === 0 ? '' : publication.year)\n    const journal = (publication.journalName ? publication.journalName : '')\n    let yearAndJournal = '';\n    if (year && journal) {\n        yearAndJournal = `${journal} (${year})`\n    } else if (journal) {\n        yearAndJournal = journal\n    } else if (year) {\n        yearAndJournal = year\n    }\n\n    let authors\n    if (!publication.authors?.length) {\n        authors = ''\n    } else if (publication.authors.length <= 2 || showAllAuthors) {\n        authors = publication.authors.map((author) => author.name).reduce((prev, next) => (prev + ', ' + next))\n    } else {\n        const firstAuthors = publication.authors.slice(0, 2).map((author) => author.name).reduce((prev, next) => (prev + ', ' + next))\n        authors =\n            <div>\n                {firstAuthors}\n                <Button\n                    variant=\"text\"\n                    style={{ textTransform: 'none', fontSize: 16, marginTop: -4, marginLeft: -8 }}\n                    onClick={() => setShowAllAuthors(true)}\n                    sx={{ p: 0, m: 0 }}\n                >\n                    et al.\n                </Button>\n            </div>\n    }\n\n    const pdfUrl = publication.pdfUrls.length > 0 ? publication.pdfUrls[0] : ''\n\n    const addSeedDisabled = addSeedPaperDisabled(publication)\n\n    return (\n        <div style={{ padding: 16, overflow: 'scroll' }}>\n            <div style={{ marginBottom: 20, fontSize: 18 }}>{publication.title}</div>\n            <div style={{ marginBottom: 4, color: 'grey' }}>{yearAndJournal}</div>\n            <div style={{ marginBottom: 14, color: 'grey' }}>{authors}</div>\n            <div style={{ marginBottom: 20, display: 'flex' }}>\n                <Tooltip title='Add to seed publications' placement='top'>\n                    <IconButton\n                        style={{ paddingTop: 4, marginRight: 8, display: 'inline-block', verticalAlign: 'top', cursor: 'pointer', flexShrink: '0' }}\n                        onClick={() => addSeedPaper(publication)}\n                        disabled={addSeedDisabled}\n                        color='primary'\n                        sx={{ p: 0 }}\n                    >\n                        <Citrus color1={addSeedDisabled ? 'grey' : '#1976d2'} color2={addSeedDisabled ? 'grey' : '#1976d2'} width={28} />\n                        <AddIcon style={{ fontSize: 16, color: addSeedDisabled ? 'grey' : '#1976d2' }} />\n                    </IconButton>\n                </Tooltip>\n                <Button\n                    variant=\"outlined\"\n                    style={{ textTransform: 'none', fontFamily: 'Poppins', marginRight: 8, padding: '0 4px 0 4px' }}\n                    onClick={() => onBrowseReferences()}\n                    disabled={!publication.outCitations.length}\n                >\n                    {`References (${publication.outCitations.length})`}\n                </Button>\n                <Button\n                    variant=\"outlined\"\n                    style={{ textTransform: 'none', fontFamily: 'Poppins', padding: '0 4px 0 4px' }}\n                    onClick={() => onBrowseCitations()}\n                    disabled={!publication.inCitations.length}\n                >\n                    {`Citations (${publication.inCitations.length})`}\n                </Button>\n                <div style={{ marginLeft: 12 }}>\n                    {pdfUrl && (\n                        <img\n                            src={pdfIcon}\n                            alt=\"pdf icon\"\n                            style={{ width: 28, marginRight: 8, cursor: 'pointer' }}\n                            onClick={() => window.open(pdfUrl, '_newtab')}\n                        />\n                    )}\n                    {publication.doiUrl && (\n                        <img\n                            src={doiIcon}\n                            alt=\"doi icon\"\n                            style={{ width: 28, marginRight: 4, cursor: 'pointer' }}\n                            onClick={() => window.open(publication.doiUrl, '_newtab')}\n                        />\n                    )}\n                    {publication.s2Url && (\n                        <img\n                            src={s2Icon}\n                            alt=\"semantic scholar icon\"\n                            style={{ width: 44, height: 32, marginRight: 4, cursor: 'pointer' }}\n                            onClick={() => window.open(publication.s2Url, '_newtab')}\n                        />\n                    )}\n                    <HtmlTooltip title={\n                        <div style={{ width: 200, backgroundColor: '#fff', boxShadow: '0px 0px 5px grey', padding: 4 }}>\n                            <div style={{ fontSize: 14, margin: '8px 0', fontFamily: 'Poppins', textAlign: 'center', color: 'black' }}>\n                                BibTex entry\n                        </div>\n                            <Button\n                                variant=\"outlined\"\n                                style={{ textTransform: 'none', fontFamily: 'Poppins', margin: '0 auto', marginBottom: 4 }}\n                                onClick={() => navigator.clipboard.writeText(generateBibTexEntry(publication))}\n                                sx={{ p: 0, display: 'block', width: '100%' }}\n                            >\n                                Copy to clipboard\n                        </Button>\n                            <Button\n                                variant=\"outlined\"\n                                style={{ textTransform: 'none', fontFamily: 'Poppins', margin: '0 auto', marginBottom: 4 }}\n                                onClick={() => saveFile(generateBibTexFilename(publication), generateBibTexEntry(publication))}\n                                sx={{ p: 0, m: 0, display: 'block', width: '100%' }}\n                            >\n                                Download .bib\n                        </Button>\n                        </div>\n                    }\n                    >\n                        <img\n                            src={bibTexIcon}\n                            alt=\"bibtex icon\"\n                            style={{ width: 20, cursor: 'pointer' }}\n                            onClick={() => { }}\n                        />\n                    </HtmlTooltip>\n                </div>\n            </div>\n            {publication.paperAbstract && (\n                <div>\n                    <div style={{ marginBottom: 10, fontWeight: 'bold' }}>Abstract</div>\n                    <div style={{ marginBottom: 14, textAlign: 'justify' }}>{publication.paperAbstract}</div>\n                </div>\n            )}\n        </div>\n    );\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(PublicationDetail);","export default __webpack_public_path__ + \"static/media/pin-tab.e24a8e0e.gif\";","import React, { useState, useEffect, useRef } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport Modal from '@mui/material/Modal';\nimport Divider from '@mui/material/Divider';\nimport IconButton from '@mui/material/IconButton';\nimport Tooltip from '@mui/material/Tooltip';\nimport Paper from '@mui/material/Paper';\nimport Button from '@mui/material/Button';\nimport CloseIcon from '@mui/icons-material/Close';\nimport AddIcon from '@mui/icons-material/Add';\nimport SearchBar from '../common/SearchBar';\nimport LoadingIndicator from '../common/LoadingIndicator';\nimport s2Icon from '../assets/s2.png'\nimport doiIcon from '../assets/doi.svg'\nimport pdfIcon from '../assets/pdf.png'\nimport { fetchCitations, fetchReferences } from '../../services/api'\n\nexport const BrowseModalTypes = {\n    BROWSE_REFERENCED: \"BROWSE_REFERENCED\",\n    BROWSE_CITING: \"BROWSE_CITING\",\n}\n\nfunction BrowseModal({\n    open,\n    onClose,\n    type,\n    publicationId,\n    publicationShortName,\n    search,\n    setSelectedPublicationId,\n    addSeedPaper,\n    addSeedPaperDisabled\n}) {\n\n    const mounted = useRef(false);\n    const [loading, setLoading] = useState(false)\n    const [error, setError] = useState(null)\n    const [publications, setPublications] = useState([])\n    const [expandedSet, setExpandedSet] = useState(new Set())\n    const [showAllAuthorsSet, setShowAllAuthorsSet] = useState(new Set())\n    const [searchQuery, setSearchQuery] = useState('')\n\n    useEffect(() => {\n        mounted.current = true;\n        return () => { mounted.current = false; };\n    }, [])\n\n    useEffect(() => {\n        setLoading(true)\n        setError(null)\n        setShowAllAuthorsSet(new Set())\n        setExpandedSet(new Set())\n        if (type === BrowseModalTypes.BROWSE_CITING) {\n            fetchCitations(publicationId)\n                .then(onResult)\n                .catch(onError)\n        } else {\n            fetchReferences(publicationId)\n                .then(onResult)\n                .catch(onError)\n        }\n    }, [publicationId, type])\n\n    function onError(err) {\n        console.log(err)\n        if (mounted.current) {\n            setError(err)\n            setLoading(false)\n        }\n    }\n\n    function onResult(response) {\n        if (mounted.current) {\n            setPublications(response)\n            setLoading(false)\n        }\n    }\n\n    const publicationList = publications\n        .filter((publication) => {\n            if (!searchQuery) {\n                return true\n            } else {\n                const regex = new RegExp(searchQuery, 'i');\n                if (regex.test(publication.title)) return true\n                if (regex.test(publication.paperAbstract)) return true\n                const allAuthors = publication.authors.map((author) => author.name).join(' ')\n                if (regex.test(allAuthors)) return true\n            }\n            return false\n        })\n        .map((publication) => {\n            const year = (publication.year === 0 ? '' : `(${publication.year})`)\n\n            let authors\n            if (!publication.authors?.length) {\n                authors = ''\n            } else if (publication.authors.length <= 2 || showAllAuthorsSet.has(publication.Id)) {\n                authors = publication.authors.map((author) => author.name).reduce((prev, next) => (prev + ', ' + next))\n            } else {\n                const firstAuthors = publication.authors.slice(0, 2).map((author) => author.name).reduce((prev, next) => (prev + ', ' + next))\n                authors =\n                    <div style={{ display: 'inline-block' }}>\n                        {firstAuthors}\n                        <Button\n                            variant=\"text\"\n                            style={{ textTransform: 'none', fontSize: 16, marginTop: -4, marginLeft: -8 }}\n                            onClick={() => {\n                                const newSet = new Set(showAllAuthorsSet)\n                                newSet.add(publication.Id)\n                                setShowAllAuthorsSet(newSet)\n                            }}\n                            sx={{ p: 0, m: 0 }}\n                        >\n                            et al.\n                    </Button>\n                    </div>\n            }\n\n            const pdfUrl = publication.pdfUrls.length > 0 ? publication.pdfUrls[0] : ''\n\n            const maxAbstractChars = 300\n            let trimmedPaperAbstract;\n            let abstractWasTrimmed = false;\n            if (publication.paperAbstract) {\n                const trimmed = publication.paperAbstract.substr(0, maxAbstractChars);\n                if (publication.paperAbstract.length > trimmed.length) {\n                    abstractWasTrimmed = true\n                }\n                // cut off at a word boundary\n                trimmedPaperAbstract = trimmed.substr(0, Math.min(trimmed.length, trimmed.lastIndexOf(\" \"))) + ' '\n            }\n\n            return (\n                <Paper elevation={3} sx={{ mb: 1 }} key={publication.Id}>\n                    <div style={{ padding: 16, position: 'relative' }}>\n                        <Tooltip title='Add to seed publications' placement='top'>\n                            <IconButton\n                                color=\"primary\"\n                                aria-label=\"add seed paper\"\n                                sx={{ p: 0, float: 'right' }}\n                                style={{ marginRight: 14 }}\n                                onClick={() => addSeedPaper(publication)}\n                                disabled={addSeedPaperDisabled(publication)}\n                            >\n                                <AddIcon fontSize=\"medium\" />\n                            </IconButton>\n                        </Tooltip>\n                        <div style={{ marginBottom: 8, fontSize: 18 }}>{publication.title}</div>\n                        <div style={{ marginBottom: 4, color: 'grey' }}>\n                            <div style={{ display: 'inline-block', marginTop: 2, marginRight: 12 }}>\n                                {pdfUrl && (\n                                    <img\n                                        src={pdfIcon}\n                                        alt=\"pdf icon\"\n                                        style={{ width: 18, marginRight: 8, cursor: 'pointer' }}\n                                        onClick={() => window.open(pdfUrl, '_newtab')}\n                                    />\n                                )}\n                                {publication.doiUrl && (\n                                    <img\n                                        src={doiIcon}\n                                        alt=\"doi icon\"\n                                        style={{ width: 18, marginRight: 4, cursor: 'pointer' }}\n                                        onClick={() => window.open(publication.doiUrl, '_newtab')}\n                                    />\n                                )}\n                                {publication.s2Url && (\n                                    <img\n                                        src={s2Icon}\n                                        alt=\"semantic scholar icon\"\n                                        style={{ width: 22, height: 18, cursor: 'pointer' }}\n                                        onClick={() => window.open(publication.s2Url, '_newtab')}\n                                    />\n                                )}\n                                {search.result.publicationById.hasOwnProperty(publication.Id) && (\n                                    < Button\n                                        variant=\"outlined\"\n                                        style={{\n                                            textTransform: 'none',\n                                            fontFamily: 'Poppins',\n                                            verticalAlign: 'top',\n                                            fontSize: 12,\n                                            marginLeft: 4,\n                                            paddingLeft: 2,\n                                            paddingRight: 2,\n                                            marginTop: -2\n                                        }}\n                                        sx={{ p: 0, m: 0 }}\n                                        onClick={() => {\n                                            onClose()\n                                            setSelectedPublicationId(publication.Id)\n                                        }}\n                                    >\n                                        Show in graph\n                                    </Button>\n                                )}\n                            </div>\n                            <div style={{ display: 'inline-block', verticalAlign: 'top' }}>\n                                {authors} <span>{year}</span>\n                            </div>\n                        </div>\n                        <div style={{ display: 'inline-block', marginBottom: 8, color: 'grey', fontSize: 14 }}>{`${publication.inCitations.length} citations`}</div>\n                        {publication.paperAbstract && (\n                            (expandedSet.has(publication.Id) || !abstractWasTrimmed) ? (<div style={{ textAlign: 'justify' }}>{publication.paperAbstract}</div>) : (\n                                <div style={{ textAlign: 'justify' }}>{trimmedPaperAbstract}\n                                    <span><Button\n                                        variant=\"text\"\n                                        style={{ textTransform: 'none', fontSize: 16, marginTop: -4 }}\n                                        onClick={() => {\n                                            const newSet = new Set(expandedSet)\n                                            newSet.add(publication.Id)\n                                            setExpandedSet(newSet)\n                                        }}\n                                        sx={{ p: 0, m: 0, color: '#888' }}\n                                    >\n                                        Read more\n                                </Button></span>\n                                </div>\n                            )\n                        )}\n                    </div>\n                </Paper >\n            )\n        })\n\n    return (\n        <Modal\n            open={open}\n            onClose={onClose}\n        >\n            <div style={{\n                position: 'absolute',\n                top: '50%',\n                left: '50%',\n                transform: 'translate(-50%, -50%)',\n                width: '80%',\n                maxWidth: 800,\n                height: '80%',\n                backgroundColor: '#ffffff',\n                boxShadow: 24,\n                padding: 32,\n                paddingTop: 24,\n                paddingBottom: 0,\n                outline: 'none',\n                display: 'flex',\n                flexDirection: 'column'\n            }}>\n                <div>\n                    <IconButton\n                        color=\"primary\"\n                        aria-label=\"close\"\n                        sx={{ p: 0, m: 0, float: 'right', clear: 'right' }}\n                        onClick={() => onClose()} >\n                        <CloseIcon />\n                    </IconButton>\n                    <div style={{ marginBottom: 4, fontSize: 18 }}>{\n                        type === BrowseModalTypes.BROWSE_CITING ? `All Citations of ${publicationShortName}` : `All References  of ${publicationShortName}`\n                    }</div>\n                    <div style={{ display: 'flex' }}>\n                        <SearchBar\n                            value={searchQuery}\n                            onChange={(newValue) => setSearchQuery(newValue)}\n                            onRequestSearch={() => { }}\n                            showSettingsButton={false}\n                            placeholder={'Search titles, authors, abstracts'}\n                            style={{\n                                marginTop: 12,\n                                marginBottom: 12,\n                                width: '70%',\n                                maxWidth: 540,\n                            }}\n                        />\n                        <div style={{ paddingTop: 20, paddingLeft: 12, color: 'grey' }}>{`${publicationList.length} publications`}</div>\n                    </div>\n                    <Divider />\n                </div>\n                {loading ? <LoadingIndicator size={100} style={{ marginTop: 200 }} /> : (\n                    error ?\n                        <div>\n                            <div style={{ textAlign: \"center\", marginTop: 200, fontSize: 42 }}></div>\n                            <div style={{ textAlign: \"center\", color: 'grey' }}>\n                                {'Something went wrong. Trying again may help.'}\n                            </div>\n                        </div> : (\n                            publications.length === 0 ? (\n                                <div>\n                                    <div style={{ textAlign: \"center\", color: 'grey', marginTop: 200 }}>\n                                        {type === BrowseModalTypes.BROWSE_CITING ? `No citing papers found.` : `No referenced papers found.`}\n                                    </div>\n                                </div>) :\n                                (<div style={{\n                                    overflow: 'scroll',\n                                    paddingTop: 4,\n                                    paddingLeft: 4,\n                                    paddingRight: 4\n                                }}\n                                >\n                                    {publicationList}\n                                </div>))\n                )}\n            </div>\n        </Modal>\n    );\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(BrowseModal);","import React, { useState, useEffect, useRef } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport Paper from '@mui/material/Paper';\nimport IconButton from '@mui/material/IconButton';\nimport CloseIcon from '@mui/icons-material/Close';\nimport PublicationDetail from './PublicationDetail';\nimport '../css/hover.css';\nimport pinTabAnimation from '../assets/pin-tab.gif'\nimport Cookies from 'js-cookie'\nimport BrowseModal, { BrowseModalTypes } from './BrowseModal';\n\n\nfunction Tab({\n    title,\n    isClosable,\n    isSelected,\n    isPinned,\n    style,\n    onClick = () => { },\n    onDoubleClick = () => { },\n    onClose = () => { }, }\n) {\n    const lastClick = useRef(null);\n\n    return (\n        <div\n            onClick={() => {\n                if (!isSelected) {\n                    onClick()\n                    return\n                }\n                const clickInFlight = lastClick.current\n                lastClick.current = Date.now()\n                if (clickInFlight) {\n                    return\n                }\n                setTimeout(function () {\n                    if ((Date.now() - lastClick.current) >= 300) {\n                        onClick()\n                    } else {\n                        onDoubleClick()\n                    }\n                    lastClick.current = null\n                }, 300);\n            }}\n            style={{\n                display: 'inline-block',\n                paddingRight: 8,\n                paddingLeft: 12,\n                color: isSelected ? 'black' : 'grey',\n                cursor: 'pointer',\n                fontSize: 16,\n                fontStyle: isPinned ? 'normal' : 'italic',\n                paddingTop: 6,\n                paddingBottom: 8,\n                borderStyle: isSelected ? 'solid' : 'solid',\n                borderWidth: isSelected ? '0px 1px 2px 1px' : '0px 1px 2px 1px',\n                boxSizing: 'border-box',\n                borderColor: isSelected ? 'red #ddd #1565c0 #ddd' : '#fff',\n                textAlign: 'center',\n                userSelect: 'none',\n                WebkitUserSelect: 'none',\n                MozUserSelect: 'none',\n                msUserSelect: 'none',\n                ...style\n            }}\n\n            className={'hoverable-tab'}\n        >\n            <span style={{ marginRight: 8 }}>{title}</span>\n            {isClosable && (\n                <IconButton\n                    className={'hoverable-tab-btn'}\n                    color=\"primary\"\n                    aria-label=\"help\"\n                    sx={{ fontSize: 14, p: 0, m: 0 }}\n                    onClick={(event) => {\n                        event.stopPropagation()\n                        onClose()\n                    }}>\n                    <CloseIcon sx={{ fontSize: 14 }} />\n                </IconButton>\n            )}\n        </div>\n    )\n}\n\nfunction tabTitle(publication) {\n    const year = (publication.year === 0 ? '' : publication.year)\n    let firstAuthorLastName;\n    if (!publication.authors?.length) {\n        firstAuthorLastName = ''\n    } else {\n        firstAuthorLastName = publication.authors[0].name.split(' ').pop()\n    }\n\n    if (year && firstAuthorLastName) {\n        return `${firstAuthorLastName}, ${year}`\n    } else if (firstAuthorLastName) {\n        return firstAuthorLastName\n    } else {\n        return '(?)'\n    }\n}\n\nfunction PublicationPanel({ search, selectedPublicationId, setSelectedPublicationId, addSeedPaper, addSeedPaperDisabled }) {\n\n    const [publications, setPublications] = useState([]) // { Id: 'asdf', isPinned: false }\n    const [showHelpTab, setShowHelpTab] = useState(!Boolean(Cookies.get('disableHelpTab')))\n    const [helpTabSelected, setHelpTabSelected] = useState(false)\n    const [browseModalState, setBrowseModalState] = useState({ open: false }) // { open: true, type: BrowseModalTypes.BROWSE_REFERENCES }\n\n    useEffect(() => {\n        if (helpTabSelected) {\n            setHelpTabSelected(false)\n        }\n        if (selectedPublicationId && !publications.map((entry) => entry.Id).includes(selectedPublicationId)) {\n            if (publications.length && !publications[publications.length - 1].isPinned) {\n                setPublications([...publications.slice(0, -1), { Id: selectedPublicationId, isPinned: false }])\n            } else {\n                setPublications([...publications, { Id: selectedPublicationId, isPinned: false }])\n            }\n        }\n    }, [selectedPublicationId])\n\n    if (!selectedPublicationId) {\n        return null;\n    }\n\n    function pinTab(publicationId) {\n        const publicationsCopy = [...publications]\n        publicationsCopy.forEach((entry) => {\n            if (entry.Id === publicationId) {\n                entry.isPinned = true\n            }\n        })\n        setPublications(publicationsCopy)\n    }\n\n    function removeTab(publicationId) {\n        const publicationsCopy = [...publications]\n        const remaining = publicationsCopy.filter((entry) => (entry.Id !== publicationId))\n        setPublications(remaining)\n        if (publicationId === selectedPublicationId) {\n            setSelectedPublicationId(remaining[0].Id)\n        }\n    }\n\n    const tabList = publications.map((entry) => {\n        const publication = search.result.publicationById[entry.Id]\n        return (\n            <Tab\n                key={entry.Id}\n                title={tabTitle(publication)}\n                isClosable={publications.length > 1}\n                isPinned={entry.isPinned}\n                isSelected={entry.Id === selectedPublicationId && !helpTabSelected}\n                onClick={() => {\n                    setHelpTabSelected(false)\n                    if (!(entry.Id === selectedPublicationId)) setSelectedPublicationId(entry.Id)\n                }}\n                onClose={() => removeTab(entry.Id)}\n                onDoubleClick={() => pinTab(entry.Id)}\n            />\n        )\n    })\n\n    if (showHelpTab) {\n        tabList.push(<Tab\n            key={'?'}\n            title={'?'}\n            style={{\n                color: '#42a5f5'\n            }}\n            isClosable={true}\n            isPinned={true}\n            isSelected={helpTabSelected}\n            onClick={() => {\n                if (!helpTabSelected) setHelpTabSelected(true)\n            }}\n            onClose={() => {\n                Cookies.set('disableHelpTab', '1')\n                setShowHelpTab(false)\n                setHelpTabSelected(false)\n            }}\n        />)\n    }\n\n    return (\n        <>\n            <Paper\n                elevation={5}\n                sx={{ mr: 20, mt: 2, width: 'calc(100% - 14px)', display: 'flex', flexDirection: 'column', height: 'calc(100% - 30px)' }}\n            >\n                <div style={{\n                    display: 'flex', flexWrap: 'wrap', marginBottom: 12,\n                }}>\n                    {tabList}\n                </div>\n                {(helpTabSelected && showHelpTab) ?\n                    <div style={{ padding: 16, paddingTop: 24, fontFamily: 'Poppins' }}>\n                        <div style={{ marginBottom: 12 }}>Double-click a publication's tab to keep it open:</div>\n                        <img style={{ height: 96, display: 'block' }} src={pinTabAnimation} alt='tab pinning gif'></img>\n                    </div>\n                    :\n                    <PublicationDetail\n                        selectedPublication={selectedPublicationId}\n                        onBrowseReferences={() => setBrowseModalState({ open: true, type: BrowseModalTypes.BROWSE_REFERENCED })}\n                        onBrowseCitations={() => setBrowseModalState({ open: true, type: BrowseModalTypes.BROWSE_CITING })}\n                        addSeedPaper={addSeedPaper}\n                        addSeedPaperDisabled={addSeedPaperDisabled}\n                    />\n                }\n            </Paper>\n            <BrowseModal\n                open={browseModalState.open}\n                type={browseModalState.type}\n                publicationId={selectedPublicationId}\n                setSelectedPublicationId={setSelectedPublicationId}\n                publicationShortName={tabTitle(search.result.publicationById[selectedPublicationId])}\n                onClose={() => setBrowseModalState({ open: false })}\n                addSeedPaper={addSeedPaper}\n                addSeedPaperDisabled={addSeedPaperDisabled}\n            />\n        </>\n    );\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(PublicationPanel);","import React, { useState, useEffect } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport IconButton from \"@mui/material/IconButton\";\nimport ArrowForwardIosIcon from '@mui/icons-material/ArrowForwardIos';\nimport ArrowBackIosNewIcon from '@mui/icons-material/ArrowBackIosNew';\nimport Switch from '@mui/material/Switch';\nimport ForceGraph from './ForceGraph';\nimport '../css/legend.css'\nimport Legend from './Legend';\nimport PublicationPanel from './PublicationPanel'\n\n\nfunction SearchResults({ search, addSeedPaper, addSeedPaperDisabled }) {\n\n    const [timeLineEnabled, setTimeLineEnabled] = useState(true)\n    const [selectedPublicationId, setSelectedPublicationId] = useState(search.result.maxRelevancePublication.Id)\n    const [detailExpanded, setDetailExpanded] = useState(true)\n    const [graphForceUpdateProp, graphForceUpdate] = useState(Math.random())\n\n    useEffect(() => {\n        // For some weird reason this is necessary.\n        // It seems like the size change resulting from the new gridTemplateColumns\n        // takes effect too late in the dom for ForeceGraph's shouldComponentUpdate to catch it.\n        setTimeout(() => graphForceUpdate(Math.random()))\n    }, [detailExpanded])\n\n    return (\n        <React.Fragment>\n            <ForceGraph\n                fakePropForForceUpdate={graphForceUpdateProp}\n                graph={search.result}\n                graphWidth={detailExpanded ? 0.6 : 1.0}\n                clipNodesToTimeline={timeLineEnabled}\n                onPublicationSelected={(Id) => setSelectedPublicationId(Id)}\n                selectedPublication={selectedPublicationId}\n                seedPaperIds={search.query.seedPaperIds}\n            />\n            <div\n                style={{\n                    position: 'absolute',\n                    bottom: 36,\n                    right: (detailExpanded ? 'calc(40% + 24px)' : 24),\n                    transition: 'right 0.5s ease-out'\n                }}\n            >\n                <Switch\n                    checked={timeLineEnabled}\n                    onChange={(event) => {\n                        setTimeLineEnabled(!timeLineEnabled)\n                    }}\n                />\n            </div>\n            <Legend />\n            <IconButton\n                onClick={() => setDetailExpanded(!detailExpanded)}\n                color='primary'\n                sx={{\n                    height: 36,\n                    width: 36,\n                    position: 'absolute',\n                    top: 60,\n                    right: detailExpanded ? '40%' : 12,\n                    transition: 'right 0.5s ease-out',\n                    zIndex: 4\n                }}\n            >\n                {detailExpanded ? (<ArrowForwardIosIcon fontSize=\"small\" />) : (<ArrowBackIosNewIcon fontSize=\"small\" />)}\n            </IconButton>\n            <div style={{\n                position: 'absolute',\n                top: 48,\n                width: '40%',\n                left: detailExpanded ? '60%' : '100%',\n                bottom: 12,\n                transition: 'left 0.5s ease-out'\n            }}>\n                <PublicationPanel\n                    selectedPublicationId={selectedPublicationId}\n                    setSelectedPublicationId={setSelectedPublicationId}\n                    addSeedPaper={addSeedPaper}\n                    addSeedPaperDisabled={addSeedPaperDisabled}\n                />\n            </div>\n        </React.Fragment>\n    );\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(SearchResults);","import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux';\nimport { compose } from \"redux\";\nimport LoadingIndicator from '../common/LoadingIndicator';\nimport { useLocation } from 'react-router-dom'\nimport Button from '@mui/material/Button'\nimport * as actions from '../../state-management/search/actions'\nimport SearchResults from './SearchResults';\nimport { MAX_SEED_PAPER_COUNT } from '../constants/constants'\nimport SearchContainer from './SearchContainer';\n\n\n\nfunction Search({ search, dispatch }) {\n    const location = useLocation()\n    const [searchQuery, setSearchQuery] = useState('')\n    const [seedPapers, setSeedPapers] = useState({})\n    const [maxPublicationCount, setMaxPublicationCount] = useState(100)\n    const [searchConfigExpanded, setSearchConfigExpanded] = useState(false)\n\n    useEffect(() => {\n        const params = new URLSearchParams(location.search);\n\n        let limit = parseInt(params.get('l'))\n        if (!isNaN(limit)) {\n            setMaxPublicationCount(limit)\n        } else {\n            limit = null\n        }\n\n        const queryString = params.get('q')\n        if (queryString) {\n            setSearchQuery(queryString)\n        }\n\n        const seedsString = params.get('s')\n        let seedPaperIds = []\n        if (seedsString) {\n            seedPaperIds = seedsString.split(',')\n        }\n\n        if (queryString || seedPaperIds.length) {\n            setSearchConfigExpanded(false)\n            dispatch(actions.search({\n                textQuery: queryString ?? '',\n                seedPaperIds: seedPaperIds,\n                maxPublicationCount: limit ?? maxPublicationCount\n            }))\n        }\n    }, [location]);\n\n    useEffect(() => {\n        if (!search.loading && !search.error && search.result) {\n            const papers = search.query.seedPaperIds\n                .filter((id) => search.result.publicationById.hasOwnProperty(id))\n                .reduce((papers, id) => {\n                    papers[id] = search.result.publicationById[id]\n                    return papers\n                }, {})\n            setSeedPapers(papers)\n        }\n    }, [search])\n\n    const seedPaperIds = Object.keys(seedPapers)\n\n    const shouldHighlightSearchButton = () => {\n        if (!search.loading && !search.error && search.result) {\n            if (search.query.maxPublicationCount !== maxPublicationCount) return true\n            if (search.query.seedPaperIds.join(',') !== seedPaperIds.join(',')) return true\n        }\n        return false\n    }\n\n    const addSeedPaper = (paper) => {\n        if (!seedPapers.hasOwnProperty(paper.Id)) {\n            setSeedPapers({\n                [paper.Id]: paper,\n                ...seedPapers\n            })\n            setSearchConfigExpanded(true)\n        }\n    }\n\n    const addSeedPaperDisabled = (p) => {\n        return Object.keys(seedPapers).length >= MAX_SEED_PAPER_COUNT || seedPapers.hasOwnProperty(p.Id)\n    }\n\n    return (\n        <>\n            <SearchContainer\n                searchQuery={searchQuery}\n                setSearchQuery={setSearchQuery}\n                shouldHighlightSearchButton={shouldHighlightSearchButton}\n                searchConfigExpanded={searchConfigExpanded}\n                setSearchConfigExpanded={setSearchConfigExpanded}\n                seedPapers={seedPapers}\n                setSeedPapers={setSeedPapers}\n                maxPublicationCount={maxPublicationCount}\n                setMaxPublicationCount={setMaxPublicationCount}\n                addSeedPaper={addSeedPaper}\n                addSeedPaperDisabled={addSeedPaperDisabled}\n            />\n            <div style={{\n                position: 'absolute',\n                maxWidth: 500,\n                top: 4,\n                right: 24,\n                zIndex: 2\n            }}>\n                <Button variant=\"text\" sx={{ width: 80, height: 36, fontFamily: 'Poppins', marginTop: 1 }}>About</Button>\n                <Button variant=\"text\" sx={{ width: 80, height: 36, fontFamily: 'Poppins', marginTop: 1 }}>Donate</Button>\n            </div>\n            {\n                search.loading && (\n                    <div>\n                        <LoadingIndicator size={100} style={{ marginTop: 260 }} />\n                        <div style={{ textAlign: \"center\", marginTop: 12, color: 'grey', fontSize: 18 }}>\n                            Searching for relevant publications...\n                    </div>\n                    </div>\n                )\n            }\n            {\n                search.error && !search.loading && (\n                    <div>\n                        <div style={{ textAlign: \"center\", marginTop: 260, fontSize: 42 }}></div>\n                        <div style={{ textAlign: \"center\", color: 'grey' }}>\n                            {'Something went wrong. Trying again may help.'}\n                        </div>\n                    </div>\n                )\n            }\n            {\n                !search.loading && !search.error && search.result && (\n                    <SearchResults\n                        addSeedPaper={addSeedPaper}\n                        addSeedPaperDisabled={addSeedPaperDisabled}\n                    />\n                )\n            }\n        </>\n    );\n}\n\nfunction mapStateToProps(state) {\n    return { search: state.search }\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        dispatch,\n    };\n}\n\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\nexport default compose(withConnect)(Search);","import React from 'react';\nimport './css/App.css'\nimport Home from './Home';\nimport Search from './search/Search'\nimport { createTheme, ThemeProvider } from '@mui/material/styles';\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n} from \"react-router-dom\";\n\n\nconst theme = createTheme({\n  typography: {\n    fontFamily: 'Roboto Slab',\n    fontSize: 14\n  },\n});\n\nfunction App() {\n\n  return (\n    <ThemeProvider theme={theme}>\n      <Router>\n        <Switch>\n          <Route path=\"/search\">\n            <Search />\n          </Route>\n          <Route path=\"/\">\n            <Home />\n          </Route>\n        </Switch>\n      </Router>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import * as actions from './actions'\n\nconst initialState = {\n    query: null,\n    result: null,\n    error: false,\n    loading: false\n};\n\nexport default function reducer(state = initialState, action) {\n    switch (action.type) {\n        case actions.SEARCH_QUERY:\n            return {\n                ...state,\n                query: action.query,\n                result: null,\n                error: false,\n                loading: true\n            }\n        case actions.SEARCH_ERROR:\n            return {\n                ...state,\n                loading: false,\n                error: true\n            };\n        case actions.SEARCH_RESULT:\n            return {\n                ...state,\n                error: false,\n                loading: false,\n                result: action.result\n            };\n        default:\n            return state;\n    }\n}","import searchReducer from './search/reducer';\nimport { combineReducers } from 'redux'\n\nexport default combineReducers({\n    search: searchReducer\n})","import * as actions from './actions'\nimport { call, put, takeLatest } from \"redux-saga/effects\";\nimport { search } from '../../services/api';\n\n\nfunction* searchQuery(action) {\n    try {\n        const publications = yield call(search, action.query);\n        const result = transformMockData(publications)\n        yield put(actions.searchResult(result))\n    } catch(error) {\n        yield put(actions.searchError(error));\n    }\n}\n\n\nfunction transformMockData(publications) {\n    const publicationById = {}\n    const citations = []\n    const similarities = []\n    let minYear = new Date().getFullYear();\n    let maxYear = 0;\n    let maxRelevanceScore = 0;\n    let maxRelevancePublication;\n    for(const publication of publications) {\n        publicationById[publication.Id] = publication\n        // add fake relevance score\n        publication.relevanceScore = Math.random()\n        if(publication.relevanceScore > maxRelevanceScore) {\n            maxRelevanceScore = publication.relevanceScore\n            maxRelevancePublication = publication\n        }\n        if(publication.year > maxYear) {\n            maxYear = publication.year\n        }\n        if(publication.year && publication.year < minYear) {\n            minYear = publication.year\n        }\n    }\n\n    // add fake citations\n    for(const publication of publications) {\n        publication.citations = []\n        const citationCount = Math.floor(Math.random() * 5) // up to 4 out citations\n        for(var i = 0; i < citationCount; i++){\n            const randomPublication = publications[Math.floor(Math.random() * publications.length)];\n            publication.citations.push(randomPublication.Id)\n            citations.push({\n                type: 'cites',\n                source: publication.Id,\n                target: randomPublication.Id\n            })\n        }\n    }\n\n    // add fake similarities\n    for(const publication of publications) {\n        publication.similarPublications = []\n        const similaritiesCount = Math.floor(Math.random() * 3) // up to 2 similar papers\n        for(var i = 0; i < similaritiesCount; i++){\n            const randomPublication = publications[Math.floor(Math.random() * publications.length)];\n            publication.similarPublications.push(randomPublication.Id)\n            similarities.push({\n                type: 'similar',\n                source: publication.Id,\n                target: randomPublication.Id\n            })\n        }\n    }\n\n    return {\n        publications,\n        publicationById,\n        citations,\n        similarities,\n        minYear,\n        maxYear,\n        maxRelevancePublication\n    }\n}\n\nexport function* watcherSaga() {\n    yield takeLatest(actions.SEARCH_QUERY, searchQuery);\n}","import * as searchSaga from './search/saga';\n\nconst sagas = {\n    ...searchSaga\n};\n\nexport function registerWithMiddleware(middleware) {\n    for (let name in sagas) {\n        middleware.run(sagas[name]);\n    }\n}","import reducer from './rootReducer'\nimport * as sagas from './rootSaga';\nimport { applyMiddleware, compose, createStore } from \"redux\";\nimport createSagaMiddleware from \"redux-saga\";\n\nconst sagaMiddleware = createSagaMiddleware();\nconst composed = compose(applyMiddleware(sagaMiddleware))\n\nexport const store = createStore(\n  reducer,\n  composed\n);\n\nsagas.registerWithMiddleware(sagaMiddleware);","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './ui/css/index.css';\nimport App from './ui/App';\nimport { store } from './state-management/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}